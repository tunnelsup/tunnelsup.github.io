<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[TunnelsUP]]></title>
  <link href="https://www.tunnelsup.com/atom.xml" rel="self"/>
  <link href="https://www.tunnelsup.com/"/>
  <updated>2022-07-18T21:59:56-07:00</updated>
  <id>https://www.tunnelsup.com/</id>
  <author>
    <name><![CDATA[Jack]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Everything You Need to Know About Websites Port Scanning You]]></title>
    <link href="https://www.tunnelsup.com/browser-portscanning/"/>
    <updated>2020-05-25T10:49:00-07:00</updated>
    <id>https://www.tunnelsup.com/browser-portscanning</id>
    <content type="html"><![CDATA[<p>Some websites can and do port scan you when you visit their site. This is sneaky and creepy behavior and I want to tell you about it.</p>

<h2>What it looks like</h2>

<p>First of all this is not your run of the mill port scanning. This isn&rsquo;t someone firing off a bunch of packets at you on different ports looking to see what you have open. No this is all done in the browser through javascript, where a website is instructing <em>your computer</em> to port scan itself, then report the results to the website.</p>

<p>Today I loaded up Microsoft Edge browser (version 44), enabled developer tools, looked at the network traffic and visited eBay.com. This is what I saw.</p>

<p><img src="https://www.tunnelsup.com/images/portscan1.jpg" alt="eBay Port Scan" /></p>

<p>As you can see the website has triggered a series of GET requests to 127.0.0.1 on 14 different ports. 127.0.0.1 is the loopback address of every computer in the world. If try to connect to that IP you will always be connecting the computer you are on. So when you visit the website, it instructs your computer, to check if these 14 ports are open, on your own computer.</p>

<p>These ports are:</p>

<table class="table"><tbody><tr><th>Program</th>
<th>Name</th>
<th>Port</th>
</tr><tr><td><strong>Unknown</strong></td>
<td>REF</td>
<td>63333</td>
</tr><tr><td><strong>VNC</strong></td>
<td>VNC</td>
<td>5900</td>
</tr><tr><td><strong>VNC</strong></td>
<td>VNC</td>
<td>5901</td>
</tr><tr><td><strong>VNC</strong></td>
<td>VNC</td>
<td>5902</td>
</tr><tr><td><strong>VNC</strong></td>
<td>VNC</td>
<td>5903</td>
</tr><tr><td><strong>Remote Desktop Protocol</strong></td>
<td>RDP</td>
<td>3389</td>
</tr><tr><td><strong>Aeroadmin</strong></td>
<td>ARO</td>
<td>5950</td>
</tr><tr><td><strong>Ammyy Admin</strong></td>
<td>AMY</td>
<td>5931</td>
</tr><tr><td><strong>TeamViewer</strong></td>
<td>TV0</td>
<td>5939</td>
</tr><tr><td><strong>TeamViewer</strong></td>
<td>TV1</td>
<td>6039</td>
</tr><tr><td><strong>TeamViewer</strong></td>
<td>TV2</td>
<td>5944</td>
</tr><tr><td><strong>TeamViewer</strong></td>
<td>TV2</td>
<td>6040</td>
</tr><tr><td><strong>Anyplace Control</strong></td>
<td>APC</td>
<td>5279</td>
</tr><tr><td><strong>AnyDesk</strong></td>
<td>ANY</td>
<td>7070</td>
</tr></tbody></table>


<p>By the way, thank you to Charlie Belmer for his blog post <a href="https://nullsweep.com/why-is-this-website-port-scanning-me/">Why Is This Website Port Scanning Me</a> which introduced me to this problem, and I only caught that post through this <a href="https://news.ycombinator.com/item?id=23246170">Hacker News</a> posting.</p>

<p>Also if you want to test this on your own, be aware that eBay only does this on the first visit to the website.</p>

<h2>How to Block This</h2>

<p>Ok first, strait up, this is creepy and I think it&rsquo;s invasive. I do not want to allow websites to do this to my computer. It&rsquo;s bypassing all the network security I have put in place. It bypasses my firewall, my AV, and my Pi Hole. Because the website instructed my computer to conduct these scans, and it&rsquo;s not coming from the internet.</p>

<p>So how do you stop it?</p>

<p>There are two browser extension that seem to do pretty good at stopping this:</p>

<p><a href="https://privacybadger.org/">Privacy Badger</a> and <a href="https://getublock.com/">uBlock Origin</a>.</p>

<p>But some browser block this behavior by default too. Brave and Opera seem to block this by default.</p>

<p>Users have reported to me that they see this scanning behavior is permitted in Chrome, Firefox, and Edge when they have no extensions enabled.</p>

<p>Also it&rsquo;s worth noting that the <a href="https://trac.torproject.org/projects/tor/ticket/10419">tor browser blocks this</a> specifically.</p>

<h2>eBay is not the only ones doing this</h2>

<p>After <a href="https://twitter.com/JackRhysider/status/1264415919691841536">raising these concerns on Twitter</a> I started getting information from people far and wide. I quickly learned that eBay is using a solution called <a href="https://risk.lexisnexis.com/products/threatmetrix">Threat Metrix</a> to conduct this. And <a href="https://www.featuredcustomers.com/vendor/threatmetrix/customers">here&rsquo;s a client list</a>.</p>

<p><img src="https://www.tunnelsup.com/images/portscan2.jpg" alt="Port Scan Info" /></p>

<p>Some big names on this list. GoPro, WePay, Netflix, Visa, Yandex, TripAdvisor, and a bunch of dating sites and finance sites. I visited 5 of these sites and watched the network traffic and didn&rsquo;t see the same scanning behavior. But I guess ThreatMetrix doesn&rsquo;t just offer scanning like this, but has other features too. So who knows what they are doing here. Perhaps extra identity proofing happens only when you login or when you go to purchase something. So potentially all of these have the technology to do this to their customers.</p>

<p>But wait. That&rsquo;s just one vendor. One solution. Surely they have competitors right? Here&rsquo;s a report from <a href="https://solutionsreview.com/identity-management/key-findings-gartner-market-guide-identity-proofing-corroboration/">Gartner regarding Identity Proofing</a>.</p>

<p>In this there are a list of Recommended Vendors.</p>

<blockquote><p>Gartner named Acuant, BioCatch, Buguroo, Emailage, Experian, EZMCOM, Fraud.net, IBM Trusteer, ID Analytics, IdentityMind, IDology, iovation, Jumio, Kount, LexisNexis Risk Solutions, Mitek, Nuance, NuData Security (A Mastercard Company), Pindrop, SecuredTorch, ThreatMetrix (A LexisNexis Risk Solutions COmpany), TransUnion, TRUSTID, and Whitepages Pro as Representative Vendors in the market.</p></blockquote>

<p>ThreatMetrix is in there. But there are so many more. Not all of these do in browser port scanning. But some certainly do.</p>

<p>But whoa. This suddenly became a huge market. This means that there are likely a lot of websites doing this.</p>

<p>But wait, this isn&rsquo;t new either. <a href="https://www.reddit.com/r/AskNetsec/comments/4j0nas/why_is_facebook_checking_my_open_ports/">Facebook was scanning their visitors back in 2016</a>.</p>

<h2>So why are they port scanning us?</h2>

<p>I think the easiest way to explain this is to look at ThreatMetrix&rsquo;s feature list. Here&rsquo;s a snippet from <a href="https://risk.lexisnexis.com/products/threatmetrix">their website</a>.</p>

<ul>
<li><strong>Context-based information</strong> detects bot attacks to perform behavioral analysis of users during periods of normal operation and compares such data to that gathered during an attack, enabling the ability to differentiate between a human and a bot the moment they login/transact.</li>
<li><strong>Deep connection analysis</strong> technologies detect the use of technologies such as hidden proxies and VPNs and allow the bank to see the true IP address, geolocation and other attributes of each event, backed by global identity data over time.</li>
<li><strong>Malware protection</strong> helps businesses mitigate the risk by being protected from Man-In-The-Browser (MITB), Remote Access Trojan (RAT), high velocity/frequency bot attacks to low-and- slow attacks mimicking legitimate customer behavior, ransomware, key logging attempts, etc.</li>
<li><strong>Trust Tags</strong> enable businesses to define, categorize, tag and differentiate between good and bad users, devices, locations or personas.</li>
<li><strong>SmartID</strong> identifies returning users that wipe cookies, use private browsing, and change other parameters to bypass traditional device fingerprinting tools. This improves returning user detection and reduces false positives.</li>
<li><strong>TrueIP</strong> accurately detects the use of location and identity cloaking services, such as hidden proxies and VPNs, allowing your business to see the true IP address, geolocation and other attributes of each transaction.</li>
</ul>


<p>Whoa nelly those are some impressive features! Ok let&rsquo;s break this down. Obviously the port scan is only a part of the solution. But combine that with other data collected on the user, then cross reference that with other data and these companies can develop a rich understanding of the user. The more the company knows about the user the better they can serve the user. Or track the user. Or deliver custom ads for the user. In some ways the user benefits but in many ways the user is losing a lot of privacy.</p>

<p>But fraud reduction seems to be the big reason why websites are doing this. If you noticed, all the ports scanned are related to remote access to a computer. There are a lot of scams where an attacker will take control of the victims computer, then try to buy something on Amazon or send money from the victim&rsquo;s bank to the attacker&rsquo;s bank. Websites have seen a lot of chargebacks, saying they didn&rsquo;t buy something that was purchased on their account. When the website tracks this purchase it shows it was from the same browser the user usually uses, the same IP everything. But the computer was remotely controlled. So by checking if any ports are open which would indicate the computer is being remotely controlled, this can help websites combat unauthorized purchases.</p>

<p>Besides helping victims stay safe from this kind of attack, websites have also seen fraudsters purchase server space in the cloud then use that server to try different usernames and passwords with. Because the fraudster can just cancel their cloud server and get a new one and the website can&rsquo;t track them. So this is another reason why websites want to know if their visitors are being remotely controlled.</p>

<p>Here&rsquo;s one article I found which says <a href="https://more.talktalk.co.uk/news/2019/09/22/lloyds-banks-fraud-detection-system-the-rat-sniffs-out-scammers">Lloyd&rsquo;s Bank has a technology to sniff out scammers</a>. It says it has a &ldquo;new high-tech defence system&rdquo; to do this. I have a strong sense that this is the use of ThreatMetrix or a competitor. And what&rsquo;s funny is this is on TalkTalk&rsquo;s website, which has <a href="https://darknetdiaries.com/episode/4/">historically been hit hard by scammers</a> who call up TalkTalk customers and con them out of money.</p>

<h2>Is this illegal?</h2>

<p>Ah the burning debate. Recently NordVPN Tweeted this:</p>

<p><img src="https://www.tunnelsup.com/images/portscan3.jpg" width="300px"></p>

<p>And a lot of the InfoSec community piled on NordVPN for saying such ridiculous things. I think we didn&rsquo;t understand that this kind of javascript browser local port scanning is even a thing. So it made no sense to us that a browser extension can block this. But also with companies like Shodan.io who portscan the entire internet legally, everyone was saying port scanning is not illegal. I mean if you open port 80 on your server and someone checks to see if it&rsquo;s open, that&rsquo;s perfectly legal. This Tweet resulted in a lot of people calling NordVPN bad names. So did NordVPN say anything wrong here?</p>

<p>To begin with this kind of port scanning is totally different than what Shodan is doing. Shodan is going to every IP on the <strong>public internet</strong> and checking what ports are open. But what eBay is doing is port scanning my PC in my private network in my home. Which is behind a firewall, and it&rsquo;s a restricted network! It&rsquo;s the difference between someone driving by my home, and looking to see if I left my front door open vs someone coming INTO my home, and checking if my bedroom door is open. I can&rsquo;t control what goes on outside my house and I get it&rsquo;s public space. But I do not authorize anyone to port scan computers inside my house! So at least to me I do not consent to this, and this is not ok with me.</p>

<p>Let&rsquo;s take a look at this Tweet from <strong>2018</strong>.</p>

<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Halifax Bank are illegally carrying out a local port scan, checking for open VNC/RDP ports. Without consent, this breaches CMA. They disagree, 3 solicitors agree.<br><br>Is anyone brave enough to take this on?<br><br>cc <a href="https://twitter.com/BBCTech?ref_src=twsrc%5Etfw">@BBCTech</a> <a href="https://twitter.com/ruskin147?ref_src=twsrc%5Etfw">@ruskin147</a> <a href="https://twitter.com/jleyden?ref_src=twsrc%5Etfw">@jleyden</a> <a href="https://twitter.com/Chrisitv?ref_src=twsrc%5Etfw">@Chrisitv</a> <a href="https://twitter.com/kevinpashby?ref_src=twsrc%5Etfw">@kevinpashby</a> <a href="https://twitter.com/dangoodin001?ref_src=twsrc%5Etfw">@dangoodin001</a> <a href="https://t.co/BSAwXWzTKb">pic.twitter.com/BSAwXWzTKb</a></p>&mdash; Paul Moore 🇬🇧 (@Paul_Reviews) <a href="https://twitter.com/Paul_Reviews/status/1025445964910350336?ref_src=twsrc%5Etfw">August 3, 2018</a></blockquote>


<p> <script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script></p>

<p>Back in 2018 Paul saw that halifax.co.uk was port scanning his PC when he visited it. Paul believes this is a direct violation of the <a href="https://www.legislation.gov.uk/ukpga/1990/18/contents">Computer Misuse Act in the UK</a>. And right in section 1 part 1 a it says:</p>

<blockquote><p>A person is guilty of an offense if—he causes a computer to perform any function with intent to secure access to any program or data held in any computer</p></blockquote>

<p>That is quite a broad statement! It&rsquo;s saying anyone who accesses any secure data on a computer is guilty of the CMA. This is a double edge sword. On one hand yes this does mean that accessing information about what ports I have on my personal computer is illegal, but on the other hand, you can use this to convict anyone. This is just way too broad to be used as a basis for anything!</p>

<p>So I think a judge will then have to look for intent. Does ThreatMetrix have <em>intent</em> on doing something malicious or harmful with the secure data they acquired through this scan? At the surface, no. They are doing this to improve customer experience and combat fraud. But what if they are negligent with their own security and get breached and now a ton of personal data about me is leaked. I did not opt in to give this data to ThreatMetrix. So if they are negligent with my data then yes absolutely they can be fined and face punishments by a court.</p>

<p>Halifax bank, which is owned by Lloyds Banking Group, which is a listed as client of ThreatMetrix, was never brought to court for this and continues to use this software.</p>

<p>This is one of those situations that this has gone right up to the edge of the line on whether it&rsquo;s legal or not. It&rsquo;s a gray area. And in this case it seems to be used for good (although I don&rsquo;t approve), but what happens when websites adopt this technology with malicious intent? Then this port scanning behavior will become criminal activity.</p>

<p>A journalist at Forbes <a href="https://www.forbes.com/sites/daveywinder/2020/05/25/did-you-know-ebay-is-probing-your-computer-heres-how-to-stop-it-windows-privacy-chrome-firefox-web-browser/#16ca00e93a92">reached out to eBay</a> for a comment and they said:</p>

<blockquote><p>&ldquo;Our customers’ privacy and data remain a top priority. We are committed to creating an experience on our sites and services that is safe, secure, and trustworthy.&rdquo;</p></blockquote>

<p>And that makes sense. They are doing this to improve security of eBay&rsquo;s assets, but it&rsquo;s at the expense of giving personal information of users to ThreatMetrix. So is the gain better than the loss?</p>

<p>This also doesn&rsquo;t seem to be adhering to GDPR data privacy regulations. So this probably in direct violation of that at the minimum.</p>

<p>Lastly you should take a look at this. <a href="https://pastebin.com/RjDeDJZq">Here is a sample of data</a> that ThreatMetrix collects on each visitor to the site through their js tracking tools.</p>

<p>This reminds me of <a href="https://panopticlick.eff.org/">Panopticlick</a>. If you run the test and click show additional data, you&rsquo;ll see how much info a website can collect on you. I ran it, and my browser data was completely unique compared to the hundreds of thousands of others who ran it. Meaning all this data my browser gave the websites means they can track me even if refuse to allow cookies and other tracking methods.</p>

<p>If I had more time I would try playing with the javascript to see if I could get it to port scan other devices in my local network. Because I think that would be going over the line on legalities. I&rsquo;m not a lawyer so I don&rsquo;t know. But what I&rsquo;ve seen from court history is that it&rsquo;s not the law that matters, it&rsquo;s whoever has the better lawyer that wins.</p>

<p>So maybe we owe NordVPN an apology for piling on them like that. They have removed their Tweet due to the enormous backlash they got. They weren&rsquo;t saying that a VPN can fix it, instead they were <a href="https://nordvpn.com/blog/use-these-browser-extensions-for-your-privacy/">linking to a blog post showing what browser extensions can help keep you more secure</a>, which is a fine blog post. Those extensions do block this port scanning. I don&rsquo;t think they deserved the backlash they got from that Tweet. This is a real problem and quite possibly illegal if not now, then it will be soon when someone abuses this.</p>

<h2>Wait, technically, how is this possible?</h2>

<p>Ya good question. Well for this I defer to Dan Nemec who breaks down the javascript involved.</p>

<p><a href="https://blog.nem.ec/2020/05/24/ebay-port-scanning/">https://blog.nem.ec/2020/05/24/ebay-port-scanning/</a></p>

<p>There is also an interesting <a href="https://www.bleepingcomputer.com/news/security/ebay-port-scans-visitors-computers-for-remote-access-programs/">article by Bleeping Computer</a> on this.</p>

<p>Lastly, a lively <a href="https://news.ycombinator.com/item?id=23246170">conversation took place on Hacker News</a> regarding this too.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[The Malicious Use of Artificial Intelligence in Cybersecurity]]></title>
    <link href="https://www.tunnelsup.com/the-malicious-use-of-artificial-intelligence-in-cybersecurity/"/>
    <updated>2018-07-20T16:47:00-07:00</updated>
    <id>https://www.tunnelsup.com/the-malicious-use-of-artificial-intelligence-in-cybersecurity</id>
    <content type="html"><![CDATA[<p><span style="font-weight: 400;">Cybersecurity is a crucial consideration for any business or organization operating today. Those who are somewhat familiar with the cybersecurity industry will know that, until recently, there was a generally very lax attitude towards the subject, sometimes alarmingly so.</span></p>


<p><span style="font-weight: 400;">Naturally, as our cybersecurity capabilities increased, cybercriminals have begun turning to increasingly sophisticated methods to carry out their attacks. There are two components to any cybersecurity system. There is the system itself, the software and computers which comprise it and run it, and then there are people.</span></p>


<p><span style="font-weight: 400;">Traditionally, people have represented the weak points of these systems. Even though we can design computerized security systems which are nearly impossible to breach, all it takes is one person being careless with a password to bring the whole thing down.</span></p>


<p><span style="font-weight: 400;">But computers are becoming more powerful and more capable. Artificial intelligence and machine learning which we have used so successfully to keep ourselves protected from cyber attacks are now being adopted and exploited by cyber crooks to thwart our efforts.</span></p>


<h2><strong>Defining AI</strong></h2>


<p><span style="font-weight: 400;">Most people have heard of artificial intelligence (AI), and could probably list at least a couple of its existing applications. Those of us who grew up pre-2000 will remember when AI was new and exciting when we had high hopes and somewhat unrealistic expectations. In today&rsquo;s world, where we are so used to many of AI&rsquo;s most common applications, we don&rsquo;t always think of them as being examples of AI.</span></p>


<p><span style="font-weight: 400;">Current applications of AI range from Amazon and Netflix recommending products and services on the basis of your previously stated preferences, all the way up to military prototypes for autonomous combat systems. Of course, most of the uses of AI fall in between these two extremes when it comes to their real-world applications. In the realm of cybersecurity, AI is used both offensively and defensively.</span></p>


<h2><strong>Good Versus Evil</strong></h2>


<p><span style="font-weight: 400;">One of the key considerations, when we are discussing the role of artificial intelligence in cybersecurity, is that AI itself has no moral bias. This means that an AI can be designed to help other computer systems and people, or it can be set to work against them. The technology itself is ethically neutral, leaving it to the architects and users of these systems to imbue them with an ethical slant.</span></p>


<p><span style="font-weight: 400;">As our understanding of AI deepens, and the hardware available to run the technology on also continues to grow in power, both the defenders and the attackers of computer systems have more to work with.</span></p>


<p><span style="font-weight: 400;">The biggest concern, from the perspective of cybersecurity professionals working to counter malicious actors, is that an increasingly sophisticated understanding of machine learning (AI that can learn how to learn) means that our most advanced defenses are rapidly rendered obsolete. Not only this, but the rise of machine learning (ML) could also lead to a sharp increase of </span><a href="https://us.norton.com/internetsecurity-emerging-threats-how-do-zero-day-vulnerabilities-work-30sectech.html"><span style="font-weight: 400;">zero-day attacks</span></a><span style="font-weight: 400;">, attacks which remain unreported to the cybersecurity community.</span></p>


<h2><strong>Malicious AI</strong></h2>


<p><span style="font-weight: 400;">There are a few ways that ML is used to undermine our best security systems. For example, a </span><a href="https://towardsdatascience.com/10-machine-learning-algorithms-you-need-to-know-77fb0055fe0"><span style="font-weight: 400;">sufficiently advanced ML-algorithm</span></a><span style="font-weight: 400;"> could, in theory, analyze the algorithms that a piece of antivirus software uses when determining if a code is malicious or not and find ways to circumvent them. Such an attack would be very sophisticated and depend upon access to privileged information regarding the cybersecurity software.</span></p>


<p><span style="font-weight: 400;">Another way that AI can undermine antivirus software is by poisoning data. We mentioned earlier that many antivirus systems rely on a regularly updated </span><a href="https://nordvpn.com/blog/malware/"><span style="font-weight: 400;">list of known malware and viruses</span></a><span style="font-weight: 400;">. By inserting false positives into these databases, and selectively deleting other entries, malicious third-parties can hijack the learning process and prevent the software from successfully identifying future malware.</span></p>


<h2><strong>Staying Safe</strong></h2>


<p><span style="font-weight: 400;">In addition to the usual antivirus software, if you want to keep yourself secure, you should invest in a VPN service. A VPN will ensure that your online traffic is encrypted at all times, making it hard to trace and attack you. Many of the best VPN services also come with a range of other tools and features for enhancing your security and protecting you from malware.</span></p>


<p><span style="font-weight: 400;">In the future, we can expect to see AI and ML playing a much more prominent role in both defending our systems and attacking them. Most technologies can quickly be put to nefarious use. It is always essential to be mindful of the nature of the Pandora&rsquo;s boxes we are opening.</span></p>


<p><br /><br /></p>


<p>Author Bio: Harold is a cybersecurity consultant and a freelance blogger. His passion for virtual security extends way back to his early teens when he aided his local public library in setting up their anti-virus software. Currently, Harold&rsquo;s working on cybersecurity campaign to raise awareness regarding virtual threats that businesses have to face on a daily basis.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Highlights from DEFCON 25]]></title>
    <link href="https://www.tunnelsup.com/highlights-from-defcon-25/"/>
    <updated>2017-08-09T12:55:00-07:00</updated>
    <id>https://www.tunnelsup.com/highlights-from-defcon-25</id>
    <content type="html"><![CDATA[<p>DEFCON 25 is now over. The largest hacking conference in the world continues to grow larger each year. Previous years there were 18-22,000 attendees. This year over 23,000 people made it to Ceasars Palace for the talks, workshops, parties, and social activities.</p>

<p>Here are some notable highlights from the event.</p>

<h2>On Lockdown</h2>

<p>When DEFCON rolls into town, some shops close their shutters to avoid potential threats. In previous years we&rsquo;ve seen the neon signs become blue screened, and many other pranks and shenanigans. This year we saw this.</p>

<p><img src="https://www.tunnelsup.com/images/defcon25-2.png">
<img src="https://www.tunnelsup.com/images/defcon25-1.png"></p>

<p>It doesn&rsquo;t seem like UPS gets it.</p>

<h2>Voting machines not as secure as you think.</h2>

<p>The big news this event is the voting machines. A total of 30 different voting machines were brought to the conference to test their security, and hilarity ensued.</p>

<p>The machines were put on the network and people were encouraged to attack them through the network. In the first 90 minutes, the first voting machine was popped. And soon additional voting machines were also found to have weak security.</p>

<p>It seems these machines weren&rsquo;t updated with patches and had additional weak security controls. When one attendee got into a machine they found the machine was still holding 650,000 voter names and votes. This was a machine that was purchased on ebay. So not only are the machine weak the data on them isn&rsquo;t being looked after properly. Another machine was found to be able to remotely change the votes on the system by a hacker.</p>

<p>Many attendees were saying the slot machines in the casino&rsquo;s are more secure than the voting machines we use to run our democratic way of life. And this is true. The slot machines undergo strict audits, not only by the game makers, but also by the gaming board. Slot machines have a long history of being secure and bug free. We all hope this is an eye opener for voting machine companies and government to take the security of these more seriously.</p>

<p><a href="https://gizmodo.com/personal-info-of-650-000-voters-discovered-on-poll-mach-1797438462">Further reading >></a></p>

<h2>Is a Car Wash Secure?</h2>

<p>Security researchers Billy Rios of WhiteScope Security and Jonathan Butts of QED Secure Solutions gave a talk that demonstrates how they can remotely take over a car wash. In this demonstration they were able to close the bay doors of the car wash and change the behavior of the spray jets. They did this through a network based attack where they could have been on the other side of the globe.</p>

<p>One reason someone might want to do this is to physically harm or trap a person in a car wash. By letting the bay doors down at the right time it can smash the car and driver which can severely impact the car and driver.</p>

<p>To be safe, maybe avoid car washes that have automatic bay doors that can trap you inside.</p>

<p><a href="https://nypost.com/2017/08/01/hackers-are-now-targeting-car-washes/amp/">Further reading >></a></p>

<h2>Work Badges Easily Cloned</h2>

<p>At DEFCON 18 I first saw someone close a security badge. The ones you might get at work, or give you access to a gated community or something. The equipment then was clunky and slow. You needed to be almost touching the badge and it would take a while.</p>

<p>The technology has improved tremendously for cloning these badges. A talk was given by Dennis Maldonado that demonstrated he can read the data of a badge from 2 feet away and then send that another 30 feet away to be processed.</p>

<p>He was able to take it a step further and make the whole thing trigger from his Pebble watch and an Android app.</p>

<p>To avoid being attacked like this and having your badge cloned without you knowing it, keep it in a safe place when not using it and consider using and RF blocker wallet to store it in.</p>

<p><a href="https://mashable.com/2017/07/27/rfid-cloning-made-easy-defcon/#u5CjK3MdRPq4">Further reading >></a></p>

<h2>Safe Cracking Robot</h2>

<p>Sparkfun founder Nathan Seidle built a combination lock cracking robot.</p>

<p><img src="https://www.tunnelsup.com/images/defcon25-3.png"></p>

<p>To demonstrate it, he bought a safe from Home Depot, attached his robot to it, and within 30 minutes the robot cracked the safe. The robot would rotate the knob back and forth feeling for just the right tension to open the safe. It needed to try numerous combinations to finally get it, but it was able to do it rapidly enough to be able to demonstrate it live on stage.</p>

<p>This certainly makes the future of safes and locks an interesting concept. This is something you might see in a sci fi movie, and is now becoming a reality.</p>

<p><a href="https://mashable.com/2017/07/28/safe-cracking-robot-defcon/#Dd6Zbft5RgqP">Further reading>></a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to edit iptables so it persists through reboot CentOS]]></title>
    <link href="https://www.tunnelsup.com/how-to-edit-iptables-so-it-persists-through-reboot-centos/"/>
    <updated>2017-06-11T23:13:00-07:00</updated>
    <id>https://www.tunnelsup.com/how-to-edit-iptables-so-it-persists-through-reboot-centos</id>
    <content type="html"><![CDATA[<p>Usually iptables are controlled by the <strong>root</strong> user or someone with <strong>sudoer</strong> privs.</p>

<p>You can check what iptables rules there are using:</p>

<p><code>iptables -L -n</code></p>

<p>That lists all the rules, and doesn&rsquo;t resolve port names or IP addresses.</p>

<p>To edit the rules, edit the following file:</p>

<p><code>/etc/sysconfig/iptables</code></p>

<p>Then you can reload those rules by doing the following:</p>

<p><code>/etc/init.d/iptables restart</code></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[When is a company ready for a SOC?]]></title>
    <link href="https://www.tunnelsup.com/when-is-a-company-ready-for-a-soc/"/>
    <updated>2017-05-25T08:29:00-07:00</updated>
    <id>https://www.tunnelsup.com/when-is-a-company-ready-for-a-soc</id>
    <content type="html"><![CDATA[<p>More and more companies are deciding to outsource their information security to another company. A Managed Security Service Provider (MSSP) is exactly that, a company that will handle the security of another company. Some MSSPs provide Security Operation Center as a service. This is the fastest and cheapest way to get a SOC. To build a SOC from scratch requires a lot of time, tools, and people. But when is a company ready to get a SOC?</p>

<h3>3 Main Types of Threats</h3>

<p>To understand when a SOC is needed, we must understand what types of threats there are.</p>

<p><strong>Generic</strong> threats are those of the &ldquo;spray and pray&rdquo; type. Imagine a vulnerability scanner, scanning the entire Internet. Imagine global worms like the WCRY (WannaCry) ransomware. These adversaries are just looking for any vulnerability on any systems in any part of the world.</p>

<p><strong>Targeted</strong> threats are attacks against a specific target or software. This may be someone who&rsquo;s goal is to damage a specific company and they will scan/social engineer/attack any open portal the company has exposed to the public. Another type of targeted attack is against specific software, like specifically looking for WordPress sites and attempting to infect those only.</p>

<p><strong>Persistent</strong> threats or otherwise known as Advanced Persistent Threat (APT) is when a highly skilled person or group is using numerous resources to infiltrate a company&rsquo;s network. Picture a tactical team of hackers with a specific mission who has access to unknown vulnerabilities (0 days) or a large pool of manpower, or a large pool of money dedicated all to a single attack. Not many groups have the resources to conduct an APT. Usually when a hacker group is conducting an APT it is for specific reasons such as political.</p>

<h3>Defending Against These Attacks</h3>

<p>Now that we have classified the 3 main types of attacks we can look at ways to defend against each of them.</p>

<p>To defend against a <strong>Generic</strong> attack, an organization should deploy best practices for securing a network. This includes not exposing unneeded ports to the Internet, patching systems, and hardening all devices.</p>

<p>To defend against a <strong>Targeted</strong> attack, an organization should architect the network with security first. This includes segmenting VLANs, denying remote logins to administrator and root, deploying firewalls, IPS units, load balancers, antivirus solutions, and setup loggers and data collectors. Create rules on loggers and data collectors that notify sys admins when a security incident has occurred in the network. In this approach we now consider the network to be fully secured and every effort put in place to stay secured.</p>

<p>To defend against a <strong>Persistent</strong> attack, an organization should be monitoring their logs, snmp traps, netflow, and sometimes full packet captures, 24/7/365 with humans and systems doing the monitoring. That is, the use of a SIEM along with technicians watching the SIEM 24 hours a day. Once an incident is detected, action should then be taken to mitigate the attack. This is called a <strong>SOC</strong>. The theory here is that an APT is usually done by humans who are extremely skilled at exploiting systems, so the defending team needs to also have humans who are skilled at detecting when a system is being exploited. No longer will passive defenses work such as firewalls and IPS units during an APT. Active defenses such as responding to the first sign of an attack are how to defend against this type of attack. Besides having a SOC to detect against these threats, an organization may have additional DFIR teams (Digital Forensics &amp; Incident Response) which can determine the who/what/why/how of an attack.</p>

<h3>Conclusion</h3>

<p>Before an organization decides to get a SOC, they should decide what types of attacks they will be facing and why. Everyone is victim to generic attacks, and most companies face a targeted attack on a regular basis. APTs are more rare and doesn&rsquo;t target every organization but takes the most amount of resources to defend against.</p>

<p>Information Security should already be a major focus on a company before they get a SOC. The network should be architected with security first and systems should already be hardened to their best effort. A SOC will spot many security issues and if the admins aren&rsquo;t already capable of securing systems they may not put a lot of focus on recommendations or findings from the SOC. If leadership has already been encouraging admins to focus on security then when SOC alerts come in, the admins should be ready to resolve the issues. It would be a waste of money to create a SOC only to ignore the alerts they report on.</p>

<p>SOCs can also interact with such teams like Malware Investigators, Digital Forensics team, Incident Responders and Threat Intelligence teams. These are obviously even more specialized teams that a company can to make responding to incidents faster, more efficient, and more accurate. These teams can sniff out where the malware came from, who did the attack, what data was leaked from the system and so on. If the organization doesn&rsquo;t care to have this information, and simply rather remove the malware and move on, then these teams aren&rsquo;t needed.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Cisco ASA Drop Reason: Unexpected-Packet]]></title>
    <link href="https://www.tunnelsup.com/cisco-asa-drop-reason-unexpected-packet/"/>
    <updated>2017-05-23T21:05:00-07:00</updated>
    <id>https://www.tunnelsup.com/cisco-asa-drop-reason-unexpected-packet</id>
    <content type="html"><![CDATA[<p>Today I was trying to send management traffic over a VPN tunnel to a Cisco ASA that terminated the tunnel. I ran into some problems doing this and I want to document my troubleshooting steps.</p>

<h3>Config</h3>

<p>Before attempting to ssh to the ASA I made sure that ssh to the ASA worked when coming from the inside of the network.</p>

<p>Then I applied the config:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>ssh 10.0.0.0 255.0.0.0 INSIDE
</span><span class='line'>management-access INSIDE</span></code></pre></td></tr></table></div></figure>


<p>Even though we are coming from the OUTSIDE, when it comes over the VPN tunnel we can get into the ASA through the INSIDE interface. Going over the VPN tunnel for ssh is more secure than doing it directly over the Internet. This also means you&rsquo;ll be sshing to the IP that is on the INSIDE of your ASA.</p>

<h3>Errors</h3>

<p>Well this didn&rsquo;t work and to see the drop reason we can do a asp-drop capture like this:</p>

<p><code>cap cap1 type asp-drop all</code></p>

<p>Then I looked at the cap including just the IP I was after and saw this:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>ASA5508# sh cap cap1 | i 192.168.128.5
</span><span class='line'>   9: 17:40:03.527957       10.50.101.6 &gt; 192.168.128.5: icmp: echo request Drop-reason: (unexpected-packet) Unexpected packet
</span><span class='line'>  10: 17:40:03.641858       10.2.11.50.49955 &gt; 192.168.128.5.161:  udp 75 Drop-reason: (unexpected-packet) Unexpected packet
</span><span class='line'>  17: 17:40:05.520206       10.50.101.6 &gt; 192.168.128.5: icmp: echo request
</span><span class='line'>  24: 17:40:07.320402       10.2.11.50 &gt; 192.168.128.5: icmp: echo request Drop-reason: (unexpected-packet) Unexpected packet
</span><span class='line'>  58: 17:40:22.546907       10.50.101.6.1030 &gt; 192.168.128.5.22: S 1027314954:1027314954(0) win 4128 &lt;mss 536&gt; Drop-reason: (unexpected-packet) Unexpected packet
</span><span class='line'>  64: 17:40:24.540224       10.50.101.6.1030 &gt; 192.168.128.5.22: S 1027314954:1027314954(0) win 4128 &lt;mss 536&gt; Drop-reason: (unexpected-packet) Unexpected packet
</span><span class='line'>  67: 17:40:25.106302       10.2.11.50.39489 &gt; 192.168.128.5.161:  udp 41 Drop-reason: (unexpected-packet) Unexpected packet
</span><span class='line'>  77: 17:40:28.541292       10.50.101.6.1030 &gt; 192.168.128.5.22: S 1027314954:1027314954(0) win 4128 &lt;mss 536&gt; Drop-reason: (unexpected-packet) Unexpected packet
</span><span class='line'>  84: 17:40:30.111276       10.2.11.50.39489 &gt; 192.168.128.5.161:  udp 41 Drop-reason: (unexpected-packet) Unexpected packet</span></code></pre></td></tr></table></div></figure>


<p>Now we have narrowed down this issue to be a drop reason of &ldquo;unexpected-packet&rdquo;.</p>

<h3>Fix</h3>

<p><a href="http://www.cisco.com/c/en/us/td/docs/security/asa/asa-command-reference/show_asp_drop/show_asp_drop.html">Cisco Writes:</a></p>

<blockquote><p>Unexpected-Packet occurs when the appliance in transparent mode receives a non-IP packet, destined to its MAC address, but there is no corresponding service running on the appliance to process the packet.</p></blockquote>

<p>But in my case this is neither a non-IP packet, nor is this firewall in transparent mode. So because Cisco is flat out wrong here, a blog post was obligatory.</p>

<p>We actually need to take a look at our <strong>NAT</strong> commands. Specifically adding the <code>route-lookup</code> option to our NAT.</p>

<p>My <strong>NONAT</strong> statement looked like this:</p>

<p><code>nat (INSIDE,any) source static LOCAL-NETS LOCAL-NETS destination static REMOTE-NETS REMOTE-NETS</code></p>

<p>This was changed to become:</p>

<p><code>nat (INSIDE,any) source static LOCAL-NETS LOCAL-NETS destination static REMOTE-NETS REMOTE-NETS route-lookup</code></p>

<p>After that, the ssh worked.</p>

<h3>Reason</h3>

<p><a href="http://www.cisco.com/c/en/us/td/docs/security/asa/asa-command-reference/I-R/cmdref2/n.html">Cisco Writes the route-lookup command:</a></p>

<blockquote><p>For identity NAT in routed mode, determines the egress interface using a route lookup instead of using the interface specified in the NAT command. If you do not specify interfaces in the NAT command, a route lookup is used by default.</p></blockquote>

<p>That means, if you have <code>any</code> in your NAT statement, the ASA isn&rsquo;t sure what interface to route the packet to (yes, even though the ASA HAS this IP on it&rsquo;s interface). By adding <code>route-lookup</code> the ASA decides to check the routing table to determine what interface to send the packet to.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Upgrade a Cisco ASA Firewall]]></title>
    <link href="https://www.tunnelsup.com/how-to-upgrade-a-cisco-asa-firewall/"/>
    <updated>2017-05-17T22:40:00-07:00</updated>
    <id>https://www.tunnelsup.com/how-to-upgrade-a-cisco-asa-firewall</id>
    <content type="html"><![CDATA[<p>To upgrade the OS of a Cisco ASA firewall follow these basic steps:</p>

<ol>
<li>Download Software</li>
<li>Get Software on ASA</li>
<li>Verify Software</li>
<li>Configure ASA</li>
<li>Reboot ASA</li>
</ol>


<h3>Download Software</h3>

<p>The general suggestion is to run the latest version of ASA OS version that the ASA supports. The OS image contains the entire OS. There are no such things as patches or updates. You download a whole new OS to be installed. Because of this there usually isn&rsquo;t a need to do a stepped upgrade. The only time you need to do a <a href="https://www.tunnelsup.com/cisco-asa-upgrade-path/">stepped upgrade is when you&rsquo;re upgrading from a very old version (pre 9.1)</a> and want the config to be migrated for you.</p>

<p>Go to the downloads section of Cisco.com (requires Cisco login with valid support contract): <a href="https://software.cisco.com/download">https://software.cisco.com/download/</a></p>

<p><strong>ASA Without FirePower IPS</strong></p>

<p>Navigate to <strong>Security</strong> > <strong>Firewalls</strong> > <strong>Adaptive Security Appliace (ASA)</strong> > <strong>ASA Model</strong> > <strong>Software on Chassis</strong> > <strong>Adaptive Security Appliance (ASA) Software</strong>.</p>

<p><strong>ASA With FirePower IPS</strong></p>

<p>Navigate to <strong>Security</strong> > <strong>Firewalls</strong> > <strong>Next-Generation Firewalls (NGFW)</strong> > <strong>ASA 5500-X with FirePOWER Services</strong> > <strong>Model of ASA</strong> > <strong>Adaptive Security Appliance (ASA) Software</strong></p>

<blockquote><p>When downloading the software, hover over the image on the downloads page to see the Checksum. Copy this checksum as we&rsquo;ll use it to verify the image later.</p></blockquote>

<h4>Understanding Versions</h4>

<p>Unlike a Cisco Router image, the ASA image contains all features and requires additional licenses to unlock the features. This makes choosing the image a lot easier but makes handling licensing harder.</p>

<p>The OS image file will look like one of these 3:</p>

<p><code>asa933-7-lfbff-k8.SPA</code><br>
<code>asa924-5-smp-K8.bin</code><br>
<code>asa924-5-k8.bin</code></p>

<p>The numbers indicate the version. For instance the first file here is for ASA OS Version 9.3(3)7.</p>

<p>The <code>lfbff</code> and <code>SPA</code> indicates it has FirePower IPS included in the image and this image is digitally signed which makes it tamper resistant.</p>

<p>The <code>smp</code> indicates the image is for a multi-core ASA (check how many cores using show ver).</p>

<p>The 3rd one is for old ASAs that have a single core.</p>

<p>The <code>k8</code> tag indicates this image supports DES encryption. With a license, you can make the ASA support AES and 3DES.</p>

<p>These images aren&rsquo;t tied to a model number, so the image downloaded for a 5512x can also be used on a 5516x.</p>

<h2>Get Software on ASA</h2>

<p>Once you have downloaded the image, upload it to the ASA.</p>

<p>Upload the image to an http or ftp server and copy the image to the ASA from the ASA command line with one of these commands:</p>

<p><code>copy http flash</code></p>

<p><code>copy ftp flash</code></p>

<p><code>copy tftp flash</code></p>

<p>You can also use a USB flash drive to put the image on and insert it into the ASA.</p>

<p><code>dir /all</code> will show you all the files on all disks</p>

<p><code>copy disk1:/filename flash</code></p>

<p>It is also possible to upload the image using the ASDM.</p>

<h2>Verify Software</h2>

<p>Now that the software is on the ASA you want to verify it got there without any errors. To do this, use the <code>verify</code> CLI command:</p>

<p><code>verify disk0:/asaxxxxxxxx.xxx</code></p>

<p>Now compare the checksum output to the checksum you saw on the downloads page from Cisco.com. If they match then this image is not corrupt.</p>

<h2>Configure ASA</h2>

<p>Apply the image to the ASA with the <code>boot system</code> command like this:</p>

<p><code>boot system disk0:/asa962-13-lfbff-k8.SPA</code></p>

<p>This will tell the ASA to boot to that image the next time there is a reboot.</p>

<h2>Reboot ASA</h2>

<p>Lastly, reboot the ASA. When it comes back up, check the version doing a <code>show ver</code>.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Python Cheat Sheet]]></title>
    <link href="https://www.tunnelsup.com/python-cheat-sheet/"/>
    <updated>2017-05-03T11:43:00-07:00</updated>
    <id>https://www.tunnelsup.com/python-cheat-sheet</id>
    <content type="html"><![CDATA[<p>Need a quick cheat sheet for using the Python programming language? Here is a quick reference guide.</p>

<p><img class="center" src="https://www.tunnelsup.com/images/PythonCheatSheet.png">
Download: <a href="https://www.tunnelsup.com/images/PythonCheatSheet.png">[PNG Image]</a> - <a href="https://www.tunnelsup.com/images/Python-CheatSheet.pdf">[PDF File]</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[YAESU-FT60 Cheat Sheet]]></title>
    <link href="https://www.tunnelsup.com/yaesu-ft60-cheat-sheet/"/>
    <updated>2017-05-03T11:36:00-07:00</updated>
    <id>https://www.tunnelsup.com/yaesu-ft60-cheat-sheet</id>
    <content type="html"><![CDATA[<p>Need a quick reference guide for the YAESU FT60 ham radio? Here is a cheat sheet for using it.</p>

<p><img class="center" src="https://www.tunnelsup.com/images/YAESU-FT60.png">
Download: <a href="https://www.tunnelsup.com/images/YAESU-FT60.png">[PNG Image]</a> - <a href="https://www.tunnelsup.com/images/YAESU-FT60-CheatSheet.pdf">[PDF File]</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Linux TTY and Terminal Commands]]></title>
    <link href="https://www.tunnelsup.com/linux-tty-and-terminal-commands/"/>
    <updated>2017-05-03T11:19:00-07:00</updated>
    <id>https://www.tunnelsup.com/linux-tty-and-terminal-commands</id>
    <content type="html"><![CDATA[<p>A few notes for using the Linux TTY terminal.</p>

<h2>Switch Terminals</h2>

<p>You can switch TTY terminals by doing:</p>

<p><code>CNTRL</code>+<code>ALT</code>+<code>F#</code></p>

<p>F2 will take you to TTY2, F3 TTY3 etc.</p>

<p>If you are using a Linux GUI, you can still use this combo to switch to the console. To get back to the GUI do <code>CNTRL</code>+<code>ALT</code>+<code>F7</code>.</p>

<h2>Scrolling</h2>

<p>If you need to scroll up or town while at the console, do:</p>

<p><code>SHIFT</code>+<code>PG UP/DOWN</code></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Juniper SRX Configurations for Route Based and Policy Based VPN]]></title>
    <link href="https://www.tunnelsup.com/juniper-srx-configurations-for-route-based-and-policy-based-vpn/"/>
    <updated>2017-03-03T20:32:00-08:00</updated>
    <id>https://www.tunnelsup.com/juniper-srx-configurations-for-route-based-and-policy-based-vpn</id>
    <content type="html"><![CDATA[<p>There are two types site-to-site of VPNs on a Juniper SRX, policy based and route based. The policy based puts the traffic in a tunnel that is defined by a policy or ACL. The route based will put all traffic in the tunnel that is routed out a specific interface.</p>

<h2>Route Based VPN</h2>

<p>In this configuration example, our peer is <code>22.22.22.22</code>. Both sides of the tunnel must be configured for route based VPN. To do this, we&rsquo;ll create an interface <code>st0</code> and route traffic into that interface. The SRX will tunnel all traffic going into that interface and send it over the VPN.</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'># Create the interface, add it to a zone, and route traffic to it
</span><span class='line'>set interfaces st0 unit 0 family inet address 192.168.180.1/32
</span><span class='line'>set security zones security-zone untrust interfaces st0.0 host-inbound-traffic system-services ike
</span><span class='line'>set routing-options static route 172.16.100.0/24 next-hop st0.0
</span><span class='line'>
</span><span class='line'># Create the IKE proposal
</span><span class='line'>set security ike propasal IKE-DH2-MD5-3DES authentication-method pre-shared-keys
</span><span class='line'>set security ike propasal IKE-DH2-MD5-3DES dh-group group2
</span><span class='line'>set security ike propasal IKE-DH2-MD5-3DES authentication-algorithm md5
</span><span class='line'>set security ike propasal IKE-DH2-MD5-3DES encryption-algorithm 3des-cbc
</span><span class='line'>set security ike propasal IKE-DH2-MD5-3DES lifetime-seconds 86400
</span><span class='line'>
</span><span class='line'># Create the IKE policy
</span><span class='line'>set security ike policy IKE-POLICY-CHI mode main
</span><span class='line'>set security ike policy IKE-POLICY-CHI proposals IKE-DH2-MD5-3DES
</span><span class='line'>set security ike policy IKE-POLICY-CHI pre-shared-key ascii-text mysekr3tkey
</span><span class='line'>
</span><span class='line'># Create the IKE gateway
</span><span class='line'>set security ike gateway IKE-GATEWAY-CHI ike-policy IKE-POLICY
</span><span class='line'>set security ike gateway IKE-GATEWAY-CHI address 22.22.22.22
</span><span class='line'>set security ike gateway IKE-GATEWAY-CHI dead-peer-detection interval 20
</span><span class='line'>set security ike gateway IKE-GATEWAY-CHI dead-peer-detection threshold 5
</span><span class='line'>set security ike gateway IKE-GATEWAY-CHI external-interface ge-0/0/1.0
</span><span class='line'>
</span><span class='line'># Create the IPSEC proposals
</span><span class='line'>set security ipsec proposal IPSEC-ESP-MD5-3DES protocol esp
</span><span class='line'>set security ipsec proposal IPSEC-ESP-MD5-3DES authentication-algorithm hmac-md5-96
</span><span class='line'>set security ipsec proposal IPSEC-ESP-MD5-3DES encryption-algorithm 3des-cbc
</span><span class='line'>set security ipsec proposal IPSEC-ESP-MD5-3DES lifetime-seconds 3200
</span><span class='line'>
</span><span class='line'># Create the IPSEC policy
</span><span class='line'>set security ipsec policy IPSEC-POLICY-CHI perfect-forward-secrecy keys group2
</span><span class='line'>set security ipsec policy IPSEC-POLICY-CHI proposals IPSEC-ESP-MD5-3DES
</span><span class='line'>
</span><span class='line'># Create the IPSEC VPN (notice the bind-interface st0.0)
</span><span class='line'>set security ipsec vpn IPSEC-VPN-CHI bind-interface st0.0
</span><span class='line'>set security ipsec vpn IPSEC-VPN-CHI ike gateway IKE-GATEWAY-CHI
</span><span class='line'>set security ipsec vpn IPSEC-VPN-CHI ike ipsec-policy IKE-POLICY-CHI
</span><span class='line'>set security ipsec vpn IPSEC-VPN-CHI establish-tunnels immediately
</span><span class='line'>
</span><span class='line'># If you have a PAT out the gateway interface then you want to exclude the VPN traffic from being NAT'd
</span><span class='line'>set security nat source rule-set NAT-INTERFACE rule NO-NAT match source-address 192.168.11.0/24
</span><span class='line'>set security nat source rule-set NAT-INTERFACE rule NO-NAT match destination-address 172.16.100.0/24
</span><span class='line'>set security nat source rule-set NAT-INTERFACE rule NO-NAT then source-nat off</span></code></pre></td></tr></table></div></figure>


<h2>Policy Based VPN</h2>

<p>In this type of tunnel, we will define the traffic for the tunnel in a policy. Any traffic that matches the policy will attempt to go over the tunnel. We&rsquo;ll build this tunnel to our peer 22.22.22.22. This peer must also be configured for policy based VPN.</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'># Create the IKE proposal
</span><span class='line'>set security ike proposal IKE-SHA-AES128-DH1 authentication-method pre-shared-keys
</span><span class='line'>set security ike proposal IKE-SHA-AES128-DH1 dh-group group2
</span><span class='line'>set security ike proposal IKE-SHA-AES128-DH1 encryption-algorithm aes-128-cbc
</span><span class='line'>set security ike proposal IKE-SHA-AES128-DH1 authentication algorithm sha1
</span><span class='line'>set security ike proposal IKE-SHA-AES128-DH1 lifetime-seconds 86400
</span><span class='line'>
</span><span class='line'># Create the IKE policy
</span><span class='line'>set security ike policy IKE-POLICY-HQ mode main
</span><span class='line'>set security ike policy IKE-POLICY-HQ proposals IKE-SHA-AES128-DH1
</span><span class='line'>set security ike policy IKE-POLICY-HQ pre-shared-key ascii-text s3kreTKey
</span><span class='line'>
</span><span class='line'># Create an IKE gateway
</span><span class='line'>set security ike gateway IKE-GATEWAY-HQ ike-policy IKE-POLICY-HQ
</span><span class='line'>set security ike gateway IKE-GATEWAY-HQ address 22.22.22.22
</span><span class='line'>set security ike gateway IKE-GATEWAY-HQ external-interface ge-0/0/0.0
</span><span class='line'>
</span><span class='line'># Create an IPSec proposal/transform set
</span><span class='line'>set security ipsec proposal IPSEC-SHA-AES128-ESP encryption-algorithm aes-128-cbc
</span><span class='line'>set security ipsec proposal IPSEC-SHA-AES128-ESP authentication-algorithm hmac-sha1-96
</span><span class='line'>set security ipsec proposal IPSEC-SHA-AES128-ESP protocol esp
</span><span class='line'>set security ipsec proposal IPSEC-SHA-AES128-ESP lifetime-seconds 3600
</span><span class='line'>
</span><span class='line'># Create a IPSec policy
</span><span class='line'>set security ipsec policy VPN-POLICY-HQ proposals IPSEC-SHA-AES128-ESP
</span><span class='line'>
</span><span class='line'># Create the IPSec VPN
</span><span class='line'>set security ipsec vpn VPN-HQ ike gateway IKE-GATEWAY-HQ
</span><span class='line'>set security ipsec vpn VPN-HQ ike ipsec-policy VPN-POLICY-HQ
</span><span class='line'>
</span><span class='line'># Add some networks into the address book
</span><span class='line'>set security zones security-zone OUTSIDE address-book address NET-REMOTE-VPN 172.16.22.0/24
</span><span class='line'>set security zones security-zone INSIDE address-book address NET-LOCAL 192.168.11.0/24
</span><span class='line'>
</span><span class='line'># Create the policies to define the interesting traffic
</span><span class='line'>set security policies from-zone INSIDE to-zone OUTSIDE policy VPN-POLICY-HQ-OUT match source-address NET-LOCAL
</span><span class='line'>set security policies from-zone INSIDE to-zone OUTSIDE policy VPN-POLICY-HQ-OUT match destination-address NET-REMOTE-VPN
</span><span class='line'>set security policies from-zone INSIDE to-zone OUTSIDE policy VPN-POLICY-HQ-OUT match application any
</span><span class='line'>set security policies from-zone INSIDE to-zone OUTSIDE policy VPN-POLICY-HQ-OUT then permit tunnel ipsec-vpn VPN-HQ
</span><span class='line'>set security policies from-zone INSIDE to-zone OUTSIDE policy VPN-POLICY-HQ-OUT then permit tunnel pair-policy VPN-POLICY-HQ-IN
</span><span class='line'>
</span><span class='line'>set security policies from-zone OUTSIDE to-zone INSIDE policy VPN-POLICY-HQ-IN match source-address NET-REMOTE-VPN
</span><span class='line'>set security policies from-zone OUTSIDE to-zone INSIDE policy VPN-POLICY-HQ-IN match destination-address NET-LOCAL
</span><span class='line'>set security policies from-zone OUTSIDE to-zone INSIDE policy VPN-POLICY-HQ-IN match application any
</span><span class='line'>set security policies from-zone OUTSIDE to-zone INSIDE policy VPN-POLICY-HQ-IN then permit tunnel ipsec-vpn VPN-HQ
</span><span class='line'>set security policies from-zone OUTSIDE to-zone INSIDE policy VPN-POLICY-HQ-IN then permit tunnel pair-policy VPN-POLICY-HQ-OUT
</span><span class='line'>
</span><span class='line'># If you have a PAT out the gateway interface then you want to exclude the VPN traffic from being NAT'd
</span><span class='line'>set security nat source rule-set NAT-INTERFACE rule NO-NAT match source-address 192.168.11.0/24
</span><span class='line'>set security nat source rule-set NAT-INTERFACE rule NO-NAT match destination-address 172.16.22.0/24
</span><span class='line'>set security nat source rule-set NAT-INTERFACE rule NO-NAT then source-nat off
</span><span class='line'>
</span><span class='line'># My config already had a rule in the rule-set. So I had to move the new rule above the old rule so it processes the no nat first.
</span><span class='line'>insert source rule-set NAT-INTERFACE rule NO-NAT before rule RULE-NAME</span></code></pre></td></tr></table></div></figure>


<h3>Troubleshooting</h3>

<p>Enable additional logging to see possibly why a VPN isn&rsquo;t forming:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>set system syslog file kmd-logs daemon info
</span><span class='line'>set system syslog file kmd-logs match KMD</span></code></pre></td></tr></table></div></figure>


<p>Then do <code>show log kdm-logs</code> and you may be able to see at what part the tunnel is failing at.</p>

<p><strong>Traceoptions</strong> is like Cisco&rsquo;s debug commands. You can enable this to see even more logs.</p>

<p>IKE Traceoptions</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>set security ike traceoptions flags ike
</span><span class='line'>set security ike traceoptions file vpn-ike</span></code></pre></td></tr></table></div></figure>


<p>Now do <code>show log vpn-ike</code> to see more information on the entire IKE process.</p>

<p>Show commands:</p>

<p><code>show security ike associations</code></p>

<p><code>show security ipsec statistics</code></p>

<h3>Additional Resources</h3>

<p>Troubleshoot a VPN tunnel that is down with this guide:</p>

<p><a href="https://kb.juniper.net/InfoCenter/index?page=content&amp;id=KB10100&amp;actp=search">https://kb.juniper.net/InfoCenter/index?page=content&amp;id=KB10100&amp;actp=search</a></p>

<p>Here is a link to help you build the VPN configuration:</p>

<p><a href="https://www.juniper.net/customers/support/configtools/vpnconfig.html">https://www.juniper.net/customers/support/configtools/vpnconfig.html</a></p>

<p>Reference guide for policy based VPNs:</p>

<p><a href="http://www.juniper.net/techpubs/en_US/junos/topics/example/policy-based-vpn-using-j-series-srx-series-device-configuring.html">http://www.juniper.net/techpubs/en_US/junos/topics/example/policy-based-vpn-using-j-series-srx-series-device-configuring.html</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Juniper SRX - ALG and Screen Options]]></title>
    <link href="https://www.tunnelsup.com/juniper-srx-alg-and-screen-options/"/>
    <updated>2017-03-03T20:12:00-08:00</updated>
    <id>https://www.tunnelsup.com/juniper-srx-alg-and-screen-options</id>
    <content type="html"><![CDATA[<p>What is ALG? What are screen options? When would I use this and why? This post will give you an introduction to these terms.</p>

<p>Screen Options and ALGs are two important security features of an SRX that detect and block abnormal traffic or attacks.</p>

<h2>ALG Application-Level Gateway</h2>

<p>The application-level gateway (ALG) feature of Juniper SRX devices acts as a fixup to certain protocols that need help getting through the firewall. Since the firewall is stateful and restrictive by default, this causes certain protocols to not get through. Think about FTP, where the initial connection comes in on port 21 but then data is transmitted on port 20. Without ALG you would have to open port 20 and 21. With Juniper SRX you can configure a FTP ALG which will know that when a session is built on port 21, build the session for port 20 and 21. This way you only have to open port 21. This is similar to fixups or inspects on a Cisco ASA.</p>

<p>You can see which ALGs are available and enabled with this command:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>srx&gt; show security alg status
</span><span class='line'>ALG Status :
</span><span class='line'>  DNS      : Enabled
</span><span class='line'>  FTP      : Enabled
</span><span class='line'>  H323     : Enabled
</span><span class='line'>  MGCP     : Enabled
</span><span class='line'>  MSRPC    : Enabled
</span><span class='line'>  PPTP     : Enabled
</span><span class='line'>  RSH      : Enabled
</span><span class='line'>  RTSP     : Enabled
</span><span class='line'>  SCCP     : Enabled
</span><span class='line'>  SIP      : Enabled
</span><span class='line'>  SQL      : Enabled
</span><span class='line'>  SUNRPC   : Enabled
</span><span class='line'>  TALK     : Enabled
</span><span class='line'>  TFTP     : Enabled</span></code></pre></td></tr></table></div></figure>


<p>There are a few ALGs enabled by default. To see these (an configuration examples), use this hidden command:</p>

<p><code>show configuration groups junos-defaults security alg</code></p>

<p>To create new ALGs put them in the <code>edit security alg</code> section of the config.</p>

<p>To apply a new ALG, add it to the application in the <code>edit application application</code> section of the config.</p>

<p>Once the ALG is applied, adjust your policy to use that application. You can then check if your policy is using an ALG with this command:</p>

<p><code>show security policies detail</code></p>

<p>You can see if a session is being hit by an ALG with <code>show security flow session</code>, and if the flow is being impacted by an ALG it will be listed there.</p>

<p>To see a more detailed explanation of what each ALG does, check here: <a href="http://www.juniper.net/documentation/en_US/junos12.1x44/information-products/pathway-pages/security/security-algs-index.html">http://www.juniper.net/documentation/en_US/junos12.1x44/information-products/pathway-pages/security/security-algs-index.html</a></p>

<h2>Screen Options</h2>

<p>Screen options are configurations applied to the firewall which act as a mini-IDS (intrusion detection system). The SRX can detect well established and known attacks such as DoS attacks, Teardrop attacks, fragmented ICMP packets, and more. There are about 30 screen options available. They are:</p>

<ul>
<li><strong>icmp/flood</strong>                       Configure icmp flood ids option</li>
<li><strong>icmp/fragment</strong>                    Enable ICMP fragment ids option</li>
<li><strong>icmp/ip-sweep</strong>                    Configure ip sweep ids option</li>
<li><strong>icmp/large</strong>                       Enable large ICMP packet (size > 1024) ids option</li>
<li><strong>icmp/ping-death</strong>                  Enable ping of death ids option</li>
<li><strong>ip/bad-option</strong>                  Enable ip with bad option ids option</li>
<li><strong>ip/block-frag</strong>                  Enable ip fragment blocking ids option</li>
<li><strong>ip/loose-source-route-option</strong>    Enable ip with loose source route ids option</li>
<li><strong>ip/record-route-option</strong>         Enable ip with record route option ids option</li>
<li><strong>ip/security-option</strong>             Enable ip with security option ids option</li>
<li><strong>ip/source-route-option</strong>         Enable ip source route ids option</li>
<li><strong>ip/spoofing</strong>                    Enable IP address spoofing ids option</li>
<li><strong>ip/stream-option</strong>               Enable ip with stream option ids option</li>
<li><strong>ip/strict-source-route-option</strong>    Enable ip with strict source route ids option</li>
<li><strong>ip/tear-drop</strong>                   Enable tear drop ids option</li>
<li><strong>ip/timestamp-option</strong>            Enable ip with timestamp option ids option</li>
<li><strong>ip/unknown-protocol</strong>            Configure unknown protocol ids option</li>
<li><strong>limit-session</strong>                    Configure connection limits</li>
<li><strong>tcp/fin-no-ack</strong>                  Enable Fin bit with no ACK bit ids option</li>
<li><strong>tcp/land</strong>                        Enable land attack ids option</li>
<li><strong>tcp/port-scan</strong>                   Configure port scan ids option</li>
<li><strong>tcp/syn-ack-ack-proxy</strong>           Enable syn-ack-ack proxy ids option</li>
<li><strong>tcp/syn-fin</strong>                     Enable SYN and FIN bits set attack ids option</li>
<li><strong>tcp/syn-flood</strong>                   Enable SYN flood ids option</li>
<li><strong>tcp/syn-frag</strong>                    Enable SYN fragment ids option</li>
<li><strong>tcp/tcp-no-flag</strong>                 Enable TCP packet without flag ids option</li>
<li><strong>tcp/winnuke</strong>                     Enable winnuke attack ids option</li>
<li><strong>udp/flood</strong>                       Configure udp flood ids option</li>
</ul>


<p>Some of these screen options are configured by default. To see which screen options are configured, look at the config here:</p>

<p><code>show configuration security screen</code></p>

<p>You can then see if the screen option is applied anywhere by doing:</p>

<p><code>show security zones</code></p>

<p>If it&rsquo;s applied you&rsquo;ll see it say <strong>Screen:</strong> and the screen policy name.</p>

<h4>Configuring Screen Options</h4>

<p>The best practice is to apply the screen to the least trusted zone. Often it is applied to the untrust zone. Traffic coming <strong>in to</strong> the zone with the screen applied, will be inspected by the screen options. Traffic going out of the zone will not be inspected by the screen.</p>

<p>Let&rsquo;s configure a new screen option to limit the number of connection to a server to only be <strong>1</strong> connection. To configure a new screen option and policy:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>set security screen ids-option UNTRUST-SCREEN limit-session destination-ip-based 1
</span><span class='line'>set security zones security-zone UNTRUST screen UNTRUST-SCREEN</span></code></pre></td></tr></table></div></figure>


<p>This creates the screen policy called &ldquo;UNTRUST-SCREEN&rdquo; which says only allow one connection inbound through the screen.</p>

<p>Then the screen policy is applied to the UNTRUST interface.</p>

<p>Once this is committed you can check the screen status with this command:</p>

<p><code>show security screen statistics zone UNTRUST</code></p>

<p>To check logs you can look at the following output:</p>

<p><code>show log messages | match RT_SCREEN</code></p>

<p>Traffic that hits the screen will show up in the messages log with this string.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[ASA5506x Fits In A 5505 Rack Mount]]></title>
    <link href="https://www.tunnelsup.com/asa5505x-fits-in-a-5505-rack-mount/"/>
    <updated>2016-11-01T22:30:00-07:00</updated>
    <id>https://www.tunnelsup.com/asa5505x-fits-in-a-5505-rack-mount</id>
    <content type="html"><![CDATA[<p>The rack mount kits for a Cisco ASA 5506x (Part number ASA-5506-RACK-MNT=) are going for over $250! That&rsquo;s almost as much as the firewall itself! This is ridiculously high.</p>

<p>But don&rsquo;t panic! You can get an older ASA 5505 rack mount kit and the 5506x will fit inside it. The older ASA 5505 mounts go for $60 or less and seem to be ok. Here are some pics from a recent swap I did.</p>

<p>ASA 5505 in an 5505 rack mount.
<img src="https://www.tunnelsup.com/images/asarack1.jpg"></p>

<p>ASA 5506x in a 5505 rack mount.
<img src="https://www.tunnelsup.com/images/asarack2.jpg"></p>

<p>ASA 5506x in a 5505 rack mount.
<img src="https://www.tunnelsup.com/images/asarack3.jpg"></p>

<p>The one problem here is that the 5506-X is longer than the 5505. This means you may have to secure it using some zip ties or something if you don&rsquo;t want it to slide around every time you put a cable in. In my case I added a few pieces of tape to keep it from moving and it worked great.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Using The Built-In macOS FTP, TFTP, SFTP, and HTTP Servers]]></title>
    <link href="https://www.tunnelsup.com/using-the-built-in-macos-ftp-tftp-sftp-and-http-servers/"/>
    <updated>2016-10-21T22:02:00-07:00</updated>
    <id>https://www.tunnelsup.com/using-the-built-in-macos-ftp-tftp-sftp-and-http-servers</id>
    <content type="html"><![CDATA[<p>The macOS and OSX operating systems come with built in FTP, TFTP, SFTP, and HTTP servers. Here is how to enable them and use them.</p>

<h2>FTP Server</h2>

<p>To start an FTP server use this terminal command:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>sudo -s launchctl load -w /System/Library/LaunchDaemons/ftp.plist</span></code></pre></td></tr></table></div></figure>


<p>Users will need to authenticate to the macOS system using standard logins that are already on the macOS. When someone logs in, they will arrive in <code>/Users/&lt;username&gt;/</code>.</p>

<p>To stop the FTP server, run the following:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>sudo launchctl unload -F /System/Library/LaunchDaemons/ftp.plist</span></code></pre></td></tr></table></div></figure>


<h2>TFTP Server</h2>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>sudo launchctl load -F /System/Library/LaunchDaemons/tftp.plist
</span><span class='line'>sudo launchctl start com.apple.tftpd</span></code></pre></td></tr></table></div></figure>


<p>The directory that serves files is <code>/private/tftpboot</code>.</p>

<p>To stop the TFTP server, either reboot or use this command:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>sudo launchctl unload -F /System/Library/LaunchDaemons/tftp.plist</span></code></pre></td></tr></table></div></figure>


<h2>SFTP Server</h2>

<p>This one is different. Go to system preferences then <code>Sharing</code>. Check the box to enabe <code>Remote Login</code>. Once this is done, other people will be able to ssh and sftp to your macOS system.</p>

<h2>HTTP Server</h2>

<p>Apache comes bundled with macOS. To start it, run this command.</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>sudo apachectl start</span></code></pre></td></tr></table></div></figure>


<p>By default the files will be served from <code>/Library/WebServer/Documents</code>.</p>

<p>To disable the server, either reboot or do this command:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>sudo apachectl stop</span></code></pre></td></tr></table></div></figure>


<h2>Checking Status</h2>

<p>To check to see what&rsquo;s running, run the command:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>netstat -an | grep LISTEN</span></code></pre></td></tr></table></div></figure>


<p>This will show you which ports are open on your macOS. For example if you have Apache running, you will see the following:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>tcp46      0      0  *.80                   *.*                    LISTEN</span></code></pre></td></tr></table></div></figure>


<ul>
<li>HTTP = TCP 80</li>
<li>FTP = TCP 21</li>
<li>SSH = TCP 22</li>
<li>SFTP = TCP 22</li>
<li>TFTP = UDP 69</li>
</ul>


<p>Note that TFTP is on UDP and won&rsquo;t say listen. Just run <code>netstat -an | grep 69</code> to find if it&rsquo;s running.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Differences between spam and phishing emails]]></title>
    <link href="https://www.tunnelsup.com/differences-between-spam-and-phishing-emails/"/>
    <updated>2016-10-15T14:47:00-07:00</updated>
    <id>https://www.tunnelsup.com/differences-between-spam-and-phishing-emails</id>
    <content type="html"><![CDATA[<p>Sometimes people send me spam mail and tell me they are being phished. Sometimes people ignore phishing emails thinking they are spam. Let&rsquo;s try to understand the differences of the two.</p>

<h2>Definitions</h2>

<p>Spam is:</p>

<blockquote><p>Unsolicited e-mail, often of a commercial nature, sent indiscriminately to multiple mailing lists, individuals, or newsgroups; junk e-mail.</p></blockquote>

<p>Phishing is:</p>

<blockquote><p>To request confidential information over the Internet under false pretenses in order to fraudulently obtain credit card numbers, passwords, or other personal data.</p></blockquote>

<h2>Spam Vs Phishing</h2>

<p>Here are some key differences.</p>

<ul>
<li>Phishing emails are usually targeted to a person. They will often have the person&rsquo;s name already in the email. Spam is more likely to be less personal.</li>
<li>Phishing usually has a sense of urgency. There may be language like &ldquo;free to first 50 people&rdquo;. Spam may not be so immediate.</li>
<li>Phishing usually is trying to get you to click a malicious link or reply to an email (instead of making a phone call).</li>
<li>Phishing links often contain malware or are intended to trick you. Spam links are often to legitimate services and websites that want to sell you a product.</li>
<li>Phishing emails are sent much less frequent than spam.</li>
<li>Phishing emails often are impersonating another company or someone you know. For instance an email that looks like it&rsquo;s from your bank but really not. Spam emails usually don&rsquo;t impersonate or try to trick you into thinking they are someone else.</li>
</ul>


<h2>Samples</h2>

<h4>Sample Spam Email</h4>

<p><img src="https://www.tunnelsup.com/images/spamphish2.png"></p>

<p>First of all this email isn&rsquo;t even to me, it&rsquo;s to someone else and I&rsquo;m in the bcc field. This email looks like it can be sent to thousands of people and not just me. Lastly, the link does in fact take you to a dating site so it&rsquo;s really just an advertisement.</p>

<h4>Sample Phishing Email</h4>

<p><img src="https://www.tunnelsup.com/images/spamphish1.png"></p>

<p>This email looks like it came from Google and I have a new message. This makes it feel like it&rsquo;s directed only to me. But looking at the from address, you can see it&rsquo;s not from Google. Hovering over the links all show that it doesn&rsquo;t take you to a Google website either.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to Create SSH Tunnels]]></title>
    <link href="https://www.tunnelsup.com/how-to-create-ssh-tunnels/"/>
    <updated>2016-10-09T16:38:00-07:00</updated>
    <id>https://www.tunnelsup.com/how-to-create-ssh-tunnels</id>
    <content type="html"><![CDATA[<p>Besides sending ssh data, the ssh protocol can tunnel other traffic between two hosts. The most common tunnels are remote and local. Knowing how to spin up an ssh tunnel can help you reach otherwise inaccessible networks and systems.</p>

<p>These examples work from a linux prompt or a macOS terminal. It&rsquo;s possible to do the same thing in Windows using applications like putty or mobaXterm.</p>

<h2>Local ssh Port Forwarding</h2>

<p>You can use a local ssh tunnel when you want to get to a resource that you can&rsquo;t get to directly, but a ssh server that you have access to can. Here are some scenarios.</p>

<h4>Proxy to Remote Server</h4>

<p><img src="https://www.tunnelsup.com/images/ssh-local2.png">
In the image above, the blue host cannot reach <code>http://192.168.0.3</code> but can ssh to 192.168.0.2. The following ssh command executed on the <strong>blue host</strong> will allow the blue host to reach the red host.</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>ssh -L 8080:192.168.0.3:80 reduser@192.168.0.2</span></code></pre></td></tr></table></div></figure>


<p>Now the blue host can open a browser, and go to <code>http://localhost:8080</code> and be presented with the webpage hosted on 192.168.0.3.</p>

<h4>Local Port Forward</h4>

<p><img src="https://www.tunnelsup.com/images/ssh-local1.png">
In the image above, the blue host wants to connect to the red host on port 80 but there&rsquo;s a firewall in between which is denying this. Because the blue host can ssh to the red host, we can create a local port forwarding ssh tunnel to access that port.</p>

<p>The command on the blue host will be:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>ssh -L 8080:192.168.0.2:80 reduser@192.168.0.2</span></code></pre></td></tr></table></div></figure>


<p>Now when the blue host opens a browser and goes to <code>http://localhost:8080</code> they will be able to see whatever the red server has at port 80.</p>

<h4>Local Port Forwarding Syntax</h4>

<p>This syntax to create a local ssh port forwarding tunnel is this:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>ssh -L &lt;LPORT&gt;:&lt;RHOST&gt;:&lt;RPORT&gt; &lt;GATEWAY&gt;</span></code></pre></td></tr></table></div></figure>


<h2>Remote SSH Port Forwarding</h2>

<p>In this scenario we are creating a reverse ssh tunnel. Here we can initiate an ssh tunnel in one direction, then use that tunnel to create an ssh tunnel back the other way. This may be useful for when you drop a drone computer inside a network and want it to &ldquo;phone home&rdquo;. Then when it phones home, you can connect to it through the established ssh tunnel.</p>

<p><img src="https://www.tunnelsup.com/images/ssh-remote.png">
We are on the green host and want to ssh to the blue host. However, the firewall blocks this connection directly. Because the blue host can ssh to the green host, we can connect using that, and when the green host wants to ssh back to the blue host, it can ride along this previously established tunnel.</p>

<p>Blue host initiates ssh tunnel like this:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>ssh -R 2222:localhost:22 greenuser@192.168.0.2</span></code></pre></td></tr></table></div></figure>


<p>This opens port 2222 on the green host, which is then port forwarding that to port 22 on the blue host. So if the green host were to ssh to itself on port 2222 it would then reach the blue host.</p>

<p>Green host can now ssh to blue host like this:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>ssh -p 2222 blueuser@localhost</span></code></pre></td></tr></table></div></figure>


<h2>Using the -N Option</h2>

<p>When using ssh, you can specify the <code>-N</code> flag which tells ssh you don&rsquo;t need to send any commands over the ssh connection when it&rsquo;s established. This option is often used when making tunnels since often we don&rsquo;t need to actually get a prompt.</p>

<h2>Autossh</h2>

<p>The autossh command is used to add persistence to your tunnels. The job it has is to verify your ssh connection is up, and if it&rsquo;s not, create it.</p>

<p>Here is an autossh command which you may recognize.</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>autossh -N -i /home/blueuser/.ssh/id_rsa -R 2222:localhost:22 greenuser@192.168.0.3</span></code></pre></td></tr></table></div></figure>


<p>The <code>-i /home/blueuser/.ssh/id_rsa</code> option says to use a certificate to authenticate this ssh connection. Check out this post to <a href="https://www.tunnelsup.com/ssh-without-password/">learn more about ssh certificates</a>.</p>

<p>Now when your tunnel goes down it will automatically try to reconnect and keep trying until it is successful. To make it persistent through a reboot, add the ssh command as a cron job.</p>

<h2>Related Articles</h2>

<ul>
<li><a href="https://www.tunnelsup.com/how-to-ssh-like-a-pro/">How to ssh like a pro</a></li>
<li><a href="https://www.tunnelsup.com/ssh-without-password/">How to ssh without a password</a></li>
</ul>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Upgrading ESXi to 5.5 and 6.0 Using a Bootable USB drive and macOS]]></title>
    <link href="https://www.tunnelsup.com/upgrading-esxi-using-a-bootable-usb-drive-and-macos/"/>
    <updated>2016-10-04T20:17:00-07:00</updated>
    <id>https://www.tunnelsup.com/upgrading-esxi-using-a-bootable-usb-drive-and-macos</id>
    <content type="html"><![CDATA[<p>I&rsquo;m not a VMWare expert so when it came time to upgrade my personal free ESXi host it took me a long time to figure it out. I didn&rsquo;t have any fancy tools or paid licenses to assist which meant it had to be done through a bootable USB drive. I had a really hard time figuring out what to do and then creating a bootable ESXi installation USB and wanted to document this for anyone else struggling.</p>

<h2>Download ESXi</h2>

<p>Even if you&rsquo;re doing an upgrade, you need to download the following:</p>

<p><strong>ESXi ISO image (Includes VMware Tools)</strong></p>

<p><a href="https://my.vmware.com/en/web/vmware/evalcenter?p=free-esxi">https://my.vmware.com/en/web/vmware/evalcenter?p=free-esxi</a></p>

<p>This is a free download from VMWare and on the same page is where your free license key is. Save that since you&rsquo;ll need it after the upgrade. It changes with each upgrade.</p>

<h2>Format the USB drive</h2>

<p>First determine which <code>/dev/driveN</code> your USB drive is plugged in to. You can simply do an <code>ls /dev/disk*</code> before and then again after you plug in the USB drive.</p>

<p>Next, you can format the drive using <code>Disk Utility</code> application that comes with macOS. When you format it, make sure to set the file system to FAT, and if you have the option, write it to the master boot record.</p>

<h2>Create a Bootable USB</h2>

<p>For some reason this part tripped me up a lot. Using a Mac running OSX I was able to get this done using UNetbootin.</p>

<h4><a href="https://unetbootin.github.io">Download UNetbootin</a></h4>

<h4>Choose the ISO Image and USB drive</h4>

<p><img class="center" src="https://www.tunnelsup.com/images/esxi-boot1.png"></p>

<h4>Overwrite menu.c32</h4>

<p>Make sure to choose yes on this option.
<img class="center" src="https://www.tunnelsup.com/images/esxi-boot2.png"></p>

<h2>Now Upgrade!</h2>

<p>Power down the ESXi host entirely, plug in a monitor and keyboard, and boot to the USB drive you just made. You&rsquo;ll have the option to install fresh or upgrade an existing ESXi installation.</p>

<p>The rest of this process is described in this video. Even though it is a video for 5.5 it is exactly the same for 6.0.</p>

<p><a href="https://www.youtube.com/watch?v=og6PeyXPQ8A">https://www.youtube.com/watch?v=og6PeyXPQ8A</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to remove meta data from a Visio document]]></title>
    <link href="https://www.tunnelsup.com/how-to-remove-meta-data-from-a-visio-document/"/>
    <updated>2016-10-02T12:59:00-07:00</updated>
    <id>https://www.tunnelsup.com/how-to-remove-meta-data-from-a-visio-document</id>
    <content type="html"><![CDATA[<p>If you create a Visio diagram and either save it or convert it to a PDF, it will contain personal meta data in it. It will try to insert your name and company name.  This is sort of like exif data on an image. It&rsquo;s a good idea to sanitize and remove all personal information before sharing it with anyone. To remove this personal data from a Visio document do the following.</p>

<h2>1. Click File > Info > Remove Personal Information</h2>

<p><img src="https://www.tunnelsup.com/images/visio-removemeta1.PNG"></p>

<h2>2. Confirm the Removal</h2>

<p><img src="https://www.tunnelsup.com/images/visio-removemeta2.PNG"></p>

<p>Now when the document is saved and when a PDF is generated, the personal information will not be in the document.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[How to remove meta data from a PDF document]]></title>
    <link href="https://www.tunnelsup.com/how-to-remove-meta-data-from-a-pdf-document/"/>
    <updated>2016-09-29T23:02:00-07:00</updated>
    <id>https://www.tunnelsup.com/how-to-remove-meta-data-from-a-pdf-document</id>
    <content type="html"><![CDATA[<p>Some PDF documents contain meta data which may contain the user&rsquo;s name that made it, the company they work for, their address, and more. This is sort of like exif data on an image. It&rsquo;s a good idea to sanitize any PDF before posting it to the Internet. To remove this personal data from a PDF do the following.</p>

<ol>
<li><p>Open Document in Adobe Acrobat
You&rsquo;ll need Acrobat and not simply Acrobat Reader. This tutorial used Adobe Acrobat XI.</p></li>
<li><p>Click the Tools Button
On the top right corner of the PDF click the Tools button.<br>
<img src="https://www.tunnelsup.com/images/pdf-meta1.PNG"></p></li>
<li><p>Click Sanitize
At the bottom of the tools is a Protection menu, expand it, and find the sanitize option.<br>
<img src="https://www.tunnelsup.com/images/pdf-meta2.PNG"></p></li>
<li><p>Confirm Sanitization
A popup box shows up and lets you verify what will be sanitized. <br>
<img src="https://www.tunnelsup.com/images/pdf-meta3.PNG"></p></li>
</ol>


<p>You&rsquo;ll then be prompted to save the sanitized document.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Cisco ASA command to show listening ports]]></title>
    <link href="https://www.tunnelsup.com/cisco-asa-command-to-show-listening-ports/"/>
    <updated>2016-09-29T15:05:00-07:00</updated>
    <id>https://www.tunnelsup.com/cisco-asa-command-to-show-listening-ports</id>
    <content type="html"><![CDATA[<p>Do you wish there was a <code>netstat</code> command for a Cisco ASA? Are you looking to see what ports the ASA has open and is listening on? Try this command:</p>

<figure class='code'><div class="highlight"><table><tr></pre></td><td class='code'><pre><code class=''><span class='line'>ASA5506# sh asp table socket
</span><span class='line'>
</span><span class='line'>Protocol  Socket    State      Local Address        Foreign Address
</span><span class='line'>SSL       0001ebf8  LISTEN     172.16.3.1:443       0.0.0.0:*
</span><span class='line'>TCP       000216f8  LISTEN     172.16.3.1:22        0.0.0.0:*
</span><span class='line'>TCP       370c1d68  LISTEN     99.99.99.99:22       0.0.0.0:*
</span><span class='line'>TCP       3712d678  ESTAB      172.16.3.1:22        172.16.2.3:50233</span></code></pre></td></tr></table></div></figure>


<p>This command displays all of the ports that are open and established on the ASA.</p>

<p>The <code>state</code> indicates whether the port is listening or established.</p>

<p>The <code>local address</code> says which IP it&rsquo;s listening on. In the example above, 99.99.99.99 is the outside interface and the 172.16.3.1 is the inside interface.</p>

<p>The <code>foreign address</code> will show up when someone connects to that port. In this case I was ssh&rsquo;d into the firewall coming from 172.16.2.3.</p>

<p>The output above should be a direct reflection of the <code>ssh</code>, <code>telnet</code>, and <code>http</code> commands in the ASA.</p>
]]></content>
  </entry>
  
</feed>
