var networkIP="",broadcastIP="",usableFirst="",usableLast="",inputIP,inputMask,inputSubSubnet="",highlightHosts="",requiredHosts="",wildcardMask,finalNetmask,maskType,ipType;$(document).ready(function(){function t(t){t=t.replace(/\//g," "),t=S(t);var r=t.split(" ");inputIP=r[0],inputMask=r[1],r.length>2&&(inputSubSubnet=r[2]),null!=inputMask&&inputMask.match(/^#/)&&(maskType="reverse",inputMask=I(inputMask))}function r(t,r,e){var n="";for(i=0;i<t.length;i++)n+=":"==t.charAt(i)?":":"F"==t.charAt(i)&&"F"==r.charAt(i)?e.charAt(i):"F"==t.charAt(i)&&"0"==r.charAt(i)?"<strong>s</strong>":"0"==t.charAt(i)&&"0"==r.charAt(i)?"h":"?";return n}function e(t,r){var e="";for(i=0;i<t.length;i++)if(":"==t.charAt(i))e+=":";else if("F"==t.charAt(i))e+=r.charAt(i);else if("E"==t.charAt(i)){var n=14,a=parseInt(r.charAt(i),16),s=n&a;s=s.toString(16),e+=s.toUpperCase()}else if("C"==t.charAt(i)){var n=12,a=parseInt(r.charAt(i),16),s=n&a;s=s.toString(16),e+=s.toUpperCase()}else if("8"==t.charAt(i)){var n=8,a=parseInt(r.charAt(i),16),s=n&a;s=s.toString(16),e+=s.toUpperCase()}else"0"==t.charAt(i)&&(e+="0");return e}function n(t,r,e){var n="";for(i=0;i<t.length;i++)if(":"==t.charAt(i))n+=":";else if("F"==t.charAt(i))n+=e.charAt(i);else if("E"==t.charAt(i)){var a=parseInt(r.charAt(i),16),s=a+1;n+=s.toString(16).toUpperCase()}else if("C"==t.charAt(i)){var a=parseInt(r.charAt(i),16),s=a+3;n+=s.toString(16).toUpperCase()}else if("8"==t.charAt(i)){var a=parseInt(r.charAt(i),16),s=a+7;n+=s.toString(16).toUpperCase()}else"0"==t.charAt(i)&&(n+="F");return n}function a(t){var r=t,e="",n="";for(i=1;i<129;i++)e+=i<=r?"1":"0",i%4==0&&(e+=":");var a=e.split(":");for(i=0;i<a.length;i++){"0000"==a[i]?n+="0":"1000"==a[i]?n+="8":"1100"==a[i]?n+="C":"1110"==a[i]?n+="E":"1111"==a[i]&&(n+="F");var s=i+1;i<a.length-2&&s%4==0&&(n+=":")}return n}function s(t){if(Math.abs(t)<1){var r=parseInt(t.toString().split("e-")[1]);r&&(t*=Math.pow(10,r-1),t="0."+new Array(r).join("0")+t.toString().substring(2))}else{var r=parseInt(t.toString().split("+")[1]);r>20&&(r-=20,t/=Math.pow(10,r),t+=new Array(r+1).join("0"))}return t}function o(t){var r="",e=t.split(":");for(i=0;i<e.length;i++)if(i<e.length-1)r=r+e[i]+":";else{var n=e[i];if(1==w(n)){var a=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,s=n.match(a),o="";for(j=1;j<5;j++){var d=parseInt(s[j]),u=d.toString(16);u.length<2&&(u="0"+u),o+=u,2==j&&(o+=":")}r+=o}else r+=e[i]}return r}function d(t){var r=t.split(":"),e="";for(i=0;i<r.length;i++){if(""==r[i]){var n=i+1;if(0==i)e+="0000";else if(n==r.length)e+="0000";else{var a=9-r.length;for(n=0;a>n;n++)e+="0000",a-1>n&&(e+=":")}}else 1==r[i].length?e=e+"000"+r[i]:2==r[i].length?e=e+"00"+r[i]:3==r[i].length?e=e+"0"+r[i]:e+=r[i];i<r.length-1&&(e+=":")}return e}function u(t){var r="",e="";return e=l(t),r=r+""+e}function l(t){var r,e,n="Not a valid IPv6 Address";return r=t.toLowerCase(),e=r.split(":"),p(e),g(e),c(e),h(e),n=f(e)}function p(t){var r=t.length;""==t[0]&&""==t[1]&&""==t[2]?(t.shift(),t.shift()):""==t[0]&&""==t[1]?t.shift():""==t[r-1]&&""==t[r-2]&&t.pop()}function g(t){var r,e=8;for(-1!=t[t.length-1].indexOf(".")&&(e=7),r=0;e>r;r++)if(""==t[r]){t[r]="0";break}for(;t.length<e;)t.splice(r,0,"0")}function c(t){var r=t.length;for(i=0;i<r;i++){for(segs=t[i].split(""),j=0;j<3&&("0"==segs[0]&&segs.length>1);j++)segs.splice(0,1);t[i]=segs.join("")}}function h(t){var r,e=-1,n=0,a=!1,i=0,s=-1;for(r=0;8>r;r++)a?"0"==t[r]?i+=1:(a=!1,i>n&&(e=s,n=i)):"0"==t[r]&&(a=!0,s=r,i=1);i>n&&(e=s,n=i),n>1&&t.splice(e,n,"")}function f(t){var r="",e=t.length;for(""==t[0]&&(r=":"),i=0;i<e&&(r+=t[i],i!=e-1);i++)r+=":";return""==t[e-1]&&(r+=":"),r}function m(t){return t>0&&129>t?!0:void 0}function k(t){return parseInt(t)>parseInt(inputMask)&&parseInt(t)<129?!0:void 0}function v(t){var r=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,e=t.match(r);for(i=1;i<5;i++){thisSegment=parseInt(e[i]),wildcardMask+=255-thisSegment,i<4&&(wildcardMask+=".")}}function b(t){var r=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,e=t.match(r);for(i=1;i<5;i++){thisSegment=parseInt(e[i]),finalNetmask+=255-thisSegment,i<4&&(finalNetmask+=".")}}function I(t){return t=t.replace(/#/,""),highlightHosts="success",requiredHosts=" (Requested: "+t+")",parseInt(t)>65534?void 0:parseInt(t)>32766?16:parseInt(t)>16382?17:parseInt(t)>8190?18:parseInt(t)>4094?19:parseInt(t)>2046?20:parseInt(t)>1022?21:parseInt(t)>510?22:parseInt(t)>254?23:parseInt(t)>126?24:parseInt(t)>62?25:parseInt(t)>30?26:parseInt(t)>14?27:parseInt(t)>6?28:parseInt(t)>2?29:parseInt(t)>1?30:void 0}function S(t){return t=t.replace(/\s+/g," "),t.replace(/^\s+|\s+$/g,"")}function M(t,r){var e=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,n=r.match(e),a=t.match(e);for(i=1;i<5;i++){var s=0;if(thisSegment=parseInt(a[i]),255==n[i])networkIP+=thisSegment,usableFirst+=thisSegment,broadcastIP+=thisSegment,usableLast+=thisSegment;else{s=256-n[i];for(var o=0;256>o;o+=s)if(thisSegment>=o&&thisSegment<o+s){networkIP+=o,broadcastIP+=o+s-1,4==i?(usableFirst+=o+1,usableLast+=o+s-2):(usableFirst+=o,usableLast+=o+s-1);break}}i<4&&(networkIP+="."),i<4&&(broadcastIP+="."),i<4&&(usableFirst+="."),i<4&&(usableLast+=".")}}function C(t){if(1==w(t))return"ipv4";if(ipv6Pattern=/^((?=.*::)(?!.*::.+::)(::)?([\dA-F]{1,4}:(:|\b)|){5}|([\dA-F]{1,4}:){6})((([\dA-F]{1,4}((?!\3)::|:\b|$))|(?!\2\3)){2}|(((2[0-4]|1\d|[1-9])?\d|25[0-5])\.?\b){4})$/i,t.match(ipv6Pattern)){var r=t.split(/:/g).length-1;return r>7?"invalid":"ipv6"}return"invalid"}function w(t){var r=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,e=t.match(r);if(null==e)return!1;for(i=1;i<5;i++){if(thisSegment=e[i],thisSegment>255)return!1;if(0==i&&thisSegment>255)return!1}return!0}function P(t){if(t>0&&33>t)return!0;var r=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,e=t.match(r);if(null==e)return!1;for(i=1;i<5;i++){if(thisSegment=parseInt(e[i]),i>2&&parseInt(e[i-1])<thisSegment)return!1;if(255!=thisSegment&&254!=thisSegment&&252!=thisSegment&&248!=thisSegment&&240!=thisSegment&&224!=thisSegment&&192!=thisSegment&&128!=thisSegment&&0!=thisSegment)return!1}return!0}function A(t){t+="";var r=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,e=t.match(r);if(null==e)return!1;for(i=1;i<5;i++){if(thisSegment=parseInt(e[i]),1==i&&0!=thisSegment)return!1;if(i>2&&parseInt(e[i-1])>thisSegment)return!1;if(255!=thisSegment&&127!=thisSegment&&63!=thisSegment&&31!=thisSegment&&15!=thisSegment&&7!=thisSegment&&3!=thisSegment&&1!=thisSegment&&0!=thisSegment)return!1}return!0}function N(t){return t>0&&33>t?!0:void 0}function y(t){return"0.0.0.0"==t?0:"128.0.0.0"==t?1:"192.0.0.0"==t?2:"224.0.0.0"==t?3:"240.0.0.0"==t?4:"248.0.0.0"==t?5:"252.0.0.0"==t?6:"254.0.0.0"==t?7:"255.0.0.0"==t?8:"255.128.0.0"==t?9:"255.192.0.0"==t?10:"255.224.0.0"==t?11:"255.240.0.0"==t?12:"255.248.0.0"==t?13:"255.252.0.0"==t?14:"255.254.0.0"==t?15:"255.255.0.0"==t?16:"255.255.128.0"==t?17:"255.255.192.0"==t?18:"255.255.224.0"==t?19:"255.255.240.0"==t?20:"255.255.248.0"==t?21:"255.255.252.0"==t?22:"255.255.254.0"==t?23:"255.255.255.0"==t?24:"255.255.255.128"==t?25:"255.255.255.192"==t?26:"255.255.255.224"==t?27:"255.255.255.240"==t?28:"255.255.255.248"==t?29:"255.255.255.252"==t?30:"255.255.255.254"==t?31:"255.255.255.255"==t?32:void 0}function F(t){return 0==t?"0.0.0.0":1==t?"128.0.0.0":2==t?"192.0.0.0":3==t?"224.0.0.0":4==t?"240.0.0.0":5==t?"248.0.0.0":6==t?"252.0.0.0":7==t?"254.0.0.0":8==t?"255.0.0.0":9==t?"255.128.0.0":10==t?"255.192.0.0":11==t?"255.224.0.0":12==t?"255.240.0.0":13==t?"255.248.0.0":14==t?"255.252.0.0":15==t?"255.254.0.0":16==t?"255.255.0.0":17==t?"255.255.128.0":18==t?"255.255.192.0":19==t?"255.255.224.0":20==t?"255.255.240.0":21==t?"255.255.248.0":22==t?"255.255.252.0":23==t?"255.255.254.0":24==t?"255.255.255.0":25==t?"255.255.255.128":26==t?"255.255.255.192":27==t?"255.255.255.224":28==t?"255.255.255.240":29==t?"255.255.255.248":30==t?"255.255.255.252":31==t?"255.255.255.254":32==t?"255.255.255.255":void 0}function T(t){var r=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,e=t.match(r);return firstSegment=e[1],firstSegment>=0&&firstSegment<128?"A (0.0.0.0 - 127.255.255.255)":firstSegment>=128&&firstSegment<192?"B (128.0.0.0 - 191.255.255.255)":firstSegment>=192&&firstSegment<224?"C (192.0.0.0 - 223.255.255.255)":firstSegment>=224&&firstSegment<240?"D (224.0.0.0 - 239.255.255.255)":firstSegment>=240&&firstSegment<256?"E (240.0.0.0 - 255.255.255.255)":void 0}function R(t){t+="",x=t.split("."),x1=x[0],x2=x.length>1?"."+x[1]:"";for(var r=/(\d+)(\d{3})/;r.test(x1);)x1=x1.replace(r,"$1,$2");return x1+x2}function _(){var t='<table class="table table-striped table-hover"><tr><td><strong>IP Address:</strong></td><td></td></tr><tr><td><strong>Netmask:</strong></td><td></td></tr><tr><td><strong>Wildcard Mask:</strong></td><td></td></tr><tr><td><strong>CIDR Notation:</strong></td><td></td></tr><tr><td><strong>Network Address:</strong></td><td></td></tr><tr><td><strong>Usable Host Range:</strong></td><td></td></tr><tr><td><strong>Broadcast Address:</strong></td><td></td></tr><tr><td><strong>Binary Netmask:</strong></td><td></td></tr><tr><td><strong>Total number of hosts:</strong></td><td></td></tr><tr><td><strong>Number of usable hosts:</strong></td><td></td></tr><tr><td><strong>IP Class:</strong></td><td></td></tr></table>';$("#results").html(t)}function q(){{var t={};window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,function(r,e,n){t[e]=n})}return t}$("#calculate").click(function(){$(".errorMessage").html(""),$(".results").html(""),networkIP="",broadcastIP="",usableFirst="",usableLast="",highlightHosts="",requiredHosts="",wildcardMask="",finalNetmask="",maskType="",ipType="",inputSubSubnet="";var l=document.subnet.ip.value;if(t(l),ipType=C(inputIP),"invalid"==ipType)return void $(".errorMessage").html("Invalid IP address.");if("ipv4"==ipType){if(null==inputMask)return void $(".errorMessage").html("Invalid hosts requirement or missing netmask. Valid number of hosts is from 2-65,000.");1==A(inputMask)&&(maskType="wildcard",b(inputMask),inputMask=finalNetmask);var p=P(inputMask);if(1!=p)return void $(".errorMessage").html("Invalid mask. See examples for possible values.");N(inputMask)?(maskType="cidr",CIDRMask=inputMask,finalNetmask=F(inputMask)):(""==maskType&&(maskType="netmask"),finalNetmask=inputMask,CIDRMask=y(inputMask)),"wildcard"==maskType?_gaq.push(["_trackEvent","Subnet Calculator","Mask Wildcard","Calculated",,!1]):"cidr"==maskType?_gaq.push(["_trackEvent","Subnet Calculator","Mask CIDR","Calculated",,!1]):"netmask"==maskType?_gaq.push(["_trackEvent","Subnet Calculator","Mask Netmask","Calculated",,!1]):"reverse"==maskType&&_gaq.push(["_trackEvent","Subnet Calculator","Mask Reverse","Calculated",,!1]);var g="",c=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,h=finalNetmask.match(c);for(i=1;i<5;i++)thisSegment=parseInt(h[i]),g+=0==thisSegment?"00000000":thisSegment.toString(2),i<4&&(g+=".");var f=T(inputIP),I=Math.pow(2,32-CIDRMask),S=I-2;v(finalNetmask),M(inputIP,finalNetmask),CIDRMask>30&&(usableFirst="N/A",usableLast="N/A");var w='<table class="table table-striped table-hover"><tr><td><strong>IP Address:</strong></td><td>'+inputIP+"</td></tr><tr><td><strong>Netmask:</strong></td><td>"+finalNetmask+"</td></tr><tr><td><strong>Wildcard Mask:</strong></td><td>"+wildcardMask+"</td></tr><tr><td><strong>CIDR Notation:</strong></td><td>/"+CIDRMask+"</td></tr><tr><td><strong>Network Address:</strong></td><td>"+networkIP+'</td></tr><tr class="info"><td><strong>Usable Host Range:</strong></td><td>'+usableFirst+" - "+usableLast+"</td></tr><tr><td><strong>Broadcast Address:</strong></td><td>"+broadcastIP+"</td></tr><tr><td><strong>Binary Netmask:</strong></td><td>"+g+"</td></tr><tr><td><strong>Total number of hosts:</strong></td><td>"+R(I)+'</td></tr><tr class="'+highlightHosts+'"><td><strong>Number of usable hosts:</strong></td><td>'+R(S)+requiredHosts+"</td></tr><tr><td><strong>IP Class:</strong></td><td>"+f+'</td></tr><tr><td><strong>Move to adjacent network</strong></td><td><button class="button netprev" type="button"><i class="icon-arrow-left"></i> Backward</button> &nbsp; <button class="button netnext" type="button">Forward <i class="icon-arrow-right"></i></button></td></tr></table>';_gaq.push(["_trackEvent","Subnet Calculator","Calculate IPv4","Clicked",,!1])}else if("ipv6"==ipType){if(void 0==inputMask&&(inputMask="128"),!m(inputMask))return void $(".errorMessage").html("Improper CIDR notation. Values can be /1 - /128.");if(""!=inputSubSubnet&&!k(inputSubSubnet))return void $(".errorMessage").html("Improper sub network defined. Value must greater than network prefix and less than /128.");var I="";inputIP=o(inputIP),inputIP=inputIP.toUpperCase();var x=d(inputIP),_=u(inputIP),q=Math.pow(2,128-inputMask);q=s(q);var E=a(inputMask),D=e(E,x),j=n(E,D,x),H=q/3.402823669209385e38;H=100*H,inputMask>26&&(H="< 0.0000001");var w='<table class="table table-striped table-hover"><tr><td><strong>Expanded Notation:</strong></td><td>'+x+"</td></tr><tr><td><strong>Condensed Notation:</strong></td><td>"+_.toUpperCase()+"</td></tr><tr><td><strong>Prefix Length:</strong></td><td>"+inputMask+"</td></tr><tr><td><strong>Network Prefix with Mask:</strong></td><td>"+D+"</td></tr><tr><td><strong>Prefix Address:</strong></td><td>"+E+'</td></tr><tr class="info"><td><strong>Host Range:</strong></td><td>'+D+" -<br>"+j+"</td></tr><tr><td><strong>Total number of hosts:</strong></td><td>"+R(q)+"</td></tr><tr><td><strong>% of total IPv6 Pool:</strong></td><td>"+H+"%</td></tr>";if(""!=inputSubSubnet){w=w+'<tr class="warning"><td><strong>Subnetwork Prefix:</strong></td><td>'+inputSubSubnet+"</td></tr>";var L=Math.pow(2,inputSubSubnet-inputMask);L=s(L),w=w+'<tr class="warning"><td><strong>Number of Subnets in Network:</strong></td><td>'+R(L)+"</td></tr>";var U=a(inputSubSubnet),B=r(U,E,x),V=Math.pow(2,128-inputSubSubnet);V=s(V),w=w+'<tr class="warning"><td><strong>Number of Hosts in Network:</strong></td><td>'+R(V)+"</td></tr>",w=w+'<tr class="warning"><td><strong>Subnet Prefix Subnetted:</strong></td><td>'+B+"</td></tr>"}w+="</table>",_gaq.push(["_trackEvent","Subnet Calculator","Calculate IPv6","Calculated",,!1])}$("#results").html(w)});var E=[];E.ip=q().ip,void 0!==E.ip&&(E.ip=E.ip.replace(/%20/gi," "),E.ip=E.ip.replace(/%2F/gi,"/"),E.ip=E.ip.replace(/%3A/gi,":"),E.ip=E.ip.replace(/%23/gi,"#"),E.ip=E.ip.replace(/\+/gi," "),document.subnet.ip.value=E.ip,$("#calculate").trigger("click")),$(document).on("click",".netprev",function(){var t=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,r=networkIP.match(t),e=parseInt(r[1]),n=parseInt(r[2]),a=parseInt(r[3]),i=parseInt(r[4]);"0"==i?"0"==a?"0"==n?"0"!=e&&(i=255,a=255,n=255,e-=1):(i=255,a=255,n-=1):(i=255,a-=1):i-=1,document.subnet.ip.value=e+"."+n+"."+a+"."+i+" "+finalNetmask,_gaq.push(["_trackEvent","Subnet Calculator","Network Backward","Clicked",,!1]),$("#calculate").click()}),$(document).on("click",".netnext",function(){var t=/^(\d{1,3})\.(\d{1,3})\.(\d{1,3})\.(\d{1,3})$/,r=broadcastIP.match(t),e=parseInt(r[1]),n=parseInt(r[2]),a=parseInt(r[3]),i=parseInt(r[4]);"255"==i?"255"==a?"255"==n?"255"!=e&&(i=0,a=0,n=0,e+=1):(i=0,a=0,n+=1):(i=0,a+=1):i+=1,document.subnet.ip.value=e+"."+n+"."+a+"."+i+" "+finalNetmask,_gaq.push(["_trackEvent","Subnet Calculator","Network Forward","Clicked",,!1]),$("#calculate").click()}),$("#random").click(function(){var t=Math.floor(223*Math.random())+1;randCIDR=128>t?Math.floor(22*Math.random())+8:192>t?Math.floor(14*Math.random())+16:Math.floor(7*Math.random())+24;var r=Math.floor(256*Math.random()),e=Math.floor(256*Math.random()),n=Math.floor(256*Math.random()),a=Math.floor(2*Math.random());randNetmask=0==a?" "+F(randCIDR):"/"+randCIDR,_gaq.push(["_trackEvent","Subnet Calculator","Random IP","Clicked",,!1]),randomIP=t+"."+r+"."+e+"."+n+randNetmask,document.subnet.ip.value=randomIP,_()}),document.getElementById("form").onsubmit=function(){return $("#calculate").click(),!1}});