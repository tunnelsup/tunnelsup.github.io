<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">

  <title><![CDATA[Category: juniper | TunnelsUP]]></title>
  <link href="https://www.tunnelsup.com/tup/tag/juniper/atom.xml" rel="self"/>
  <link href="https://www.tunnelsup.com/"/>
  <updated>2016-10-15T15:20:45-07:00</updated>
  <id>https://www.tunnelsup.com/</id>
  <author>
    <name><![CDATA[Jack]]></name>
    
  </author>
  <generator uri="http://octopress.org/">Octopress</generator>

  
  <entry>
    <title type="html"><![CDATA[Sample Juniper JunOS Config for SRX210]]></title>
    <link href="https://www.tunnelsup.com/sample-juniper-junos-config-for-srx210/"/>
    <updated>2016-04-16T23:23:00-07:00</updated>
    <id>https://www.tunnelsup.com/sample-juniper-junos-config-for-srx210</id>
    <content type="html"><![CDATA[<p>Need a quick template to get you started deploying a Juniper SRX 210? These are usually firewalls that go into a small office or home office. In our configuration below, it is plugging into a cable modem, and has no DMZ or static NATs.</p>

<p>```
set system host-name MY-SRX210
set system name-server 8.8.8.8
set system services ssh
set system services web-management http
set system services web-management https system-generated-certificate
set system services web-management https interface ge-0/0/0.0
set system services dhcp router 192.168.200.2
set system services dhcp router 192.168.201.1
set system services dhcp pool 192.168.201.0/24 address-range low 192.168.201.33
set system services dhcp pool 192.168.201.0/24 address-range high 192.168.201.95
set system services dhcp propagate-settings ge-0/0/0.0
set system syslog archive size 100k
set system syslog archive files 3
set system syslog file messages any critical
set system syslog file messages authorization info
set system syslog file interactive-commands interactive-commands error
set system max-configurations-on-flash 5
set system max-configuration-rollbacks 5
set system license autoupdate url <a href="https://ae1.juniper.net/junos/key_retrieval">https://ae1.juniper.net/junos/key_retrieval</a>
set interfaces ge-0/0/0 description OUTSIDE
set interfaces ge-0/0/0 unit 0 family inet dhcp
set interfaces ge-0/0/1 description INSIDE
set interfaces ge-0/0/1 unit 0 family inet address 192.168.100.1/24</p>

<p>set routing-options static route 192.168.0.0/16 next-hop 192.168.100.2
set routing-options static route 0.0.0.0/0 next-hop 44.44.44.44
set security nat source rule-set NAT-INSIDE from zone INSIDE
set security nat source rule-set NAT-INSIDE to zone OUTSIDE
set security nat source rule-set NAT-INSIDE rule RULE1 match source-address 192.168.0.0/16
set security nat source rule-set NAT-INSIDE rule RULE1 match destination-address 0.0.0.0/0
set security nat source rule-set NAT-INSIDE rule RULE1 then source-nat interface
set security screen ids-option SCREEN-OUTSIDE icmp ping-death
set security screen ids-option SCREEN-OUTSIDE ip source-route-option
set security screen ids-option SCREEN-OUTSIDE ip tear-drop
set security screen ids-option SCREEN-OUTSIDE tcp syn-flood alarm-threshold 1024
set security screen ids-option SCREEN-OUTSIDE tcp syn-flood attack-threshold 200
set security screen ids-option SCREEN-OUTSIDE tcp syn-flood source-threshold 1024
set security screen ids-option SCREEN-OUTSIDE tcp syn-flood destination-threshold 2048
set security screen ids-option SCREEN-OUTSIDE tcp syn-flood timeout 20
set security screen ids-option SCREEN-OUTSIDE tcp land
set security zones security-zone OUTSIDE screen SCREEN-OUTSIDE
set security zones security-zone OUTSIDE interfaces ge-0/0/0.0 host-inbound-traffic system-services dhcp
set security zones security-zone INSIDE address-book address MGT-PC 192.168.0.0/24
set security zones security-zone INSIDE address-book address NET-LOCAL 192.168.0.0/16
set security zones security-zone INSIDE host-inbound-traffic system-services all
set security zones security-zone INSIDE host-inbound-traffic protocols all
set security zones security-zone INSIDE interfaces ge-0/0/1.0 host-inbound-traffic system-services snmp
set security zones security-zone INSIDE interfaces ge-0/0/1.0 host-inbound-traffic system-services all</p>

<p>set security policies from-zone INSIDE to-zone OUTSIDE policy POL-INSIDE-TO-OUTSIDE match source-address any
set security policies from-zone INSIDE to-zone OUTSIDE policy POL-INSIDE-TO-OUTSIDE match destination-address any
set security policies from-zone INSIDE to-zone OUTSIDE policy POL-INSIDE-TO-OUTSIDE match application any
set security policies from-zone INSIDE to-zone OUTSIDE policy POL-INSIDE-TO-OUTSIDE then permit
set security policies from-zone INSIDE to-zone OUTSIDE policy POL-INSIDE-TO-OUTSIDE then count</p>

<p>set security policies from-zone INSIDE to-zone OUTSIDE policy P-DENY-ALL match source-address any
set security policies from-zone INSIDE to-zone OUTSIDE policy P-DENY-ALL match destination-address any
set security policies from-zone INSIDE to-zone OUTSIDE policy P-DENY-ALL match application any
set security policies from-zone INSIDE to-zone OUTSIDE policy P-DENY-ALL then deny
set security policies from-zone INSIDE to-zone OUTSIDE policy P-DENY-ALL then log session-init
set security policies from-zone INSIDE to-zone OUTSIDE policy P-DENY-ALL then count
set security flow tcp-mss ipsec-vpn mss 1350
set applications application-set MGT-SERVICES application junos-https
set applications application-set MGT-SERVICES application junos-ssh
```</p>

<h3>Quick start checklist</h3>

<p>Here&rsquo;s is the bare minimum you need to get an SRX set up.</p>

<ol>
<li>Configure the interfaces.</li>
<li>Configure a NAT or PAT for all addresses to be NAT&rsquo;d to the outside or untrust interface.</li>
<li>Create a policy to only permit what is required and deny everything else.</li>
<li>Create any users and ssh access to the system.</li>
<li>Configure any routes that are required.</li>
<li>(Optional) enable the screen commands to enable firewall inspection.</li>
<li>(Optional) configure the SRX to act as a DHCP server to give out addresses.</li>
</ol>

]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Troubleshooting high CPU on Juniper SRX Junos devices]]></title>
    <link href="https://www.tunnelsup.com/troubleshooting-high-cpu-on-juniper-srx-junos-devices/"/>
    <updated>2015-09-30T19:20:00-07:00</updated>
    <id>https://www.tunnelsup.com/troubleshooting-high-cpu-on-juniper-srx-junos-devices</id>
    <content type="html"><![CDATA[<p>Occasionally a Juniper SRX device running Junos will have a high CPU. Here are some tips for troubleshooting these incidents.</p>

<h2>Validate</h2>

<p>Check the routing engine (control plane). Check the CPU status by doing <code>show chassis routing-engine</code>.</p>

<p>```
user@USPHIFW1> show chassis routing-engine
Routing Engine status:</p>

<pre><code>Temperature                 40 degrees C / 104 degrees F
CPU temperature             38 degrees C / 100 degrees F
Total memory              1024 MB Max   758 MB used ( 74 percent)
  Control plane memory     560 MB Max   442 MB used ( 79 percent)
  Data plane memory        464 MB Max   316 MB used ( 68 percent)
CPU utilization:
  User                      90 percent
  Background                 0 percent
  Kernel                     6 percent
  Interrupt                  0 percent
  Idle                       4 percent
Model                          RE-SRX240H
Serial ID                      AAEM9236
Start time                     2014-02-23 10:25:39 CST
Uptime                         584 days, 7 hours, 58 minutes, 37 seconds
Last reboot reason             0x1:power cycle/failure
Load averages:                 1 minute   5 minute  15 minute
                                   0.46       0.48       0.49
</code></pre>

<p>```</p>

<p>Above you can see that the CPUs are 4% idle which means it&rsquo;s 96% utilized. I would say anything over 90% is considered bad. Once the CPU gets gets to 100% utilization it will start dropping packets and possibly overheating.</p>

<p>Next you want to look further and see what processes are running high. Do this with the command <code>show system processes extensive</code>.</p>

<p>```
user@USPHIFW1> show system processes extensive
last pid: 15924;  load averages:  0.50,  0.50,  0.50  up 584+08:03:00    19:28:16
149 processes: 19 running, 115 sleeping, 3 zombie, 12 waiting</p>

<p>Mem: 172M Active, 140M Inact, 539M Wired, 73M Cache, 112M Buf, 46M Free Swap:</p>

<p>  PID USERNAME       THR PRI NICE   SIZE    RES STATE  C   TIME   WCPU COMMAND
 1306 nobody           2 139    0  8996K  3440K RUN    0  20.5H 7518.75% httpd
 1377 root             7  76    0   499M 52316K select 0    ??? 281.15% flowd_octeon_hm
 1106 root             1  87    0 13692K  3200K RUN    0 1712.2 22.51% eventd
15922 root             1   4    0  7732K  2968K sbwait 0   0:00  2.25% sshd
```</p>

<p>Usually even under good conditions, there will be processes that are running at well over 100% utilization. The Junos does a terrible job at adding in this case, something to do with multi core processors confusing the output. You can do <code>start shell</code> then <code>top -H</code> to see the actual utilization per core.</p>

<h2>Analyze the processes</h2>

<p>Now that you know what processes are running high, we can look into why it&rsquo;s causing it.</p>

<h3>Process: httpd</h3>

<p>If you see the process <code>httpd</code> as one of the <strong>first three</strong> processes with the highest CPU, chances are the web UI is having issues and needs to be restarted. Restarting this process only impacts any user that are currently in the web UI of this SRX.</p>

<p>To restart the httpd process run the following command:</p>

<p><code>
restart web-management
</code></p>

<p>This will immediately restart the process without confirmation. After doing so, look at <code>show chassis routing-engine</code> over and over to see if the percent idle has gone up over 30%. If so, that has fixed your problem.</p>

<p>I very frequently see this process get stuck at a high percent. I&rsquo;m not sure what causes it, but the fix is quick and easy so that&rsquo;s nice.</p>

<h3>Process: eventd</h3>

<p>If the process <code>eventd</code> is running high (over 20%) then this is probably something worth looking into. This process handles the events on the Juniper device itself which includes:</p>

<ul>
<li>Storing internal syslog messages</li>
<li>Sending syslog messages to another system</li>
<li>Sending/responding to SNMP traps/polls</li>
<li>Sampling handling</li>
<li>Traceoptions handling</li>
</ul>


<p>If this is running high check if any of the above are turned on a little too high. Perhaps too many traceoptions are on, or too much sampling is turned on. Try turning these off and see if the CPU goes back to normal.</p>

<p>There are two modes for syslogs, event and stream. Perhaps changing it to stream will reduce the CPU utilization.</p>

<h3>Process: flowd_octeon</h3>

<p>The process <code>flowd_octeon</code> seems to always run over 200%. This is normal. Usually this isn&rsquo;t the problem and try looking at the next highest CPU hog as the culprit.</p>

<p>This processes is responsible for packet handling, data processing, or flow processing. The flow processing is all done on the data plane.</p>

<h5>Check the packet forwarding engine (data plane)</h5>

<p>The following two commands shows us what&rsquo;s happening on the data plane.</p>

<p><code>
user@USPHIFW1&gt; show chassis forwarding
FWDD status:
  State                                 Online
  Microkernel CPU utilization         5 percent
  Real-time threads CPU utilization   0 percent
  Heap utilization                   68 percent
  Buffer utilization                  1 percent
  Uptime:                               584 days, 8 hours, 43 minutes, 30 seconds
</code></p>

<p>```
user@USPHIFW1> show security monitoring fpc 0
FPC 0
  PIC 0</p>

<pre><code>CPU utilization      :    2 %
Memory utilization   :   68 %
Current flow session :  929
Max flow session     : 131072
</code></pre>

<p>Session Creation Per Second (for last 96 seconds on average):    0
```</p>

<p>If the CPU utilization here is low, then you don&rsquo;t have a problem with the data plane.</p>

<p><a href="http://www.juniper.net/documentation/en_US/junos12.1/topics/concept/chassis-cluster-data-plane-understanding.html">The data plane (aka forwarding plane)</a> is where the SRX decides what to do with the packet. This is where the SRX looks at the forwarding table and routing table to determine where to send the packet. If your CPU here is high, then it&rsquo;s possible you are reaching the capacity of this device. Start looking at things like how many packets and bytes each interface is receiving and comparing it with the model specifications.</p>

<p>To examine the throughput of each interface use the following command:</p>

<p><code>show interfaces detail | match "link is Up| bps| pps" | except "0 bps|0 pps"</code></p>

<p>To examine the number of sessions use the following command:</p>

<p><code>show security flow statistics</code></p>

<p>Check the model for limitations here:</p>

<p><a href="http://www.juniper.net/us/en/products-services/security/srx-series/compare/#a=SRX100,SRX110,SRX210,SRX220,SRX240,SRX300,SRX550,SRX650,SRX1400,SRX1500,SRX3400,SRX3600,SRX5400,SRX5600,SRX5800">http://www.juniper.net/us/en/products-services/security/srx-series/compare/#a=SRX100,SRX110,SRX210,SRX220,SRX240,SRX300,SRX550,SRX650,SRX1400,SRX1500,SRX3400,SRX3600,SRX5400,SRX5600,SRX5800</a></p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Useful Juniper SRX Troubleshooting Commands]]></title>
    <link href="https://www.tunnelsup.com/useful-juniper-srx-troubleshooting-commands/"/>
    <updated>2015-09-06T13:04:00-07:00</updated>
    <id>https://www.tunnelsup.com/useful-juniper-srx-troubleshooting-commands</id>
    <content type="html"><![CDATA[<p>Here&rsquo;s a list of my favorite Juniper SRX Junos commands I use for troubleshooting.</p>

<h3>Show config as single lines instead of stanzas</h3>

<p><code>
edit
show | display set
</code></p>

<p>This is useful for displaying the config to look more like the way a Cisco config looks. It&rsquo;s easier to search for keywords in the config with this command by doing things like <code>show | display set | match interface</code>.</p>

<h3>Show the connections going through the SRX</h3>

<p><code>
user@SRX1&gt; show security flow session
Session ID: 18999, Policy name: POL-INSIDE-TO-OUTSIDE/6, Timeout: 1632
  In: 172.16.200.43/37689 --&gt; 199.199.199.199/443;tcp, If: ge-0/0/1.0
  Out: 199.199.199.199/443 --&gt; 200.200.200.200/8915;tcp, If: ge-0/0/0.0
</code></p>

<p>This will show detailed information of all the connections and flows going through the SRX. The output will look like this.</p>

<p>The output above displays a user on the inside going to a website on the outside. The user IP is <code>172.16.200.43</code>, the web server is <code>199.199.199.199</code>, and the SRX NAT&rsquo;d this outbound flow to <code>200.200.200.200</code>.</p>

<h3>See uncommitted changes</h3>

<p><code>
edit
show | compare
</code></p>

<p>When you want to make changes to an SRX it&rsquo;s best to check whether there are any uncommited changes before you begin making changes. This commands shows you what those are.</p>

<h3>Show previous commits</h3>

<p>```
user@SRX-1> edit
Entering configuration mode</p>

<p>[edit]
user@SRX-1# rollback ?
Possible completions:
  &lt;[Enter]>            Execute this command
  0                    2015-06-15 20:23:16 UTC by zaphod via cli
  1                    2015-05-19 23:40:21 UTC by arthur via cli
  2                    2015-05-17 23:35:05 UTC by zaphod via cli
  3                    2015-05-16 23:34:35 UTC by arthur via cli
  4                    2015-05-11 23:33:20 UTC by ford via cli
  5                    2015-05-10 23:31:48 UTC by ford via cli
  |                    Pipe through a command
[edit]
```</p>

<p>The output above shows you the history of who did a change and when. This is why it&rsquo;s important that each user has their own username.</p>

<h3>See what was in a previous commit</h3>

<p><code>
edit
show | compare rollback 5
</code></p>

<p>This will display the contents of rollback 5.</p>

<h3>Show CPU/Uptime/memory/temperature</h3>

<p><code>
show chassis routing-engine
</code></p>

<p>Useful command to give a snapshot of multiple health statistics.</p>

<h3>Show front panel alarms</h3>

<p><code>
show chassis craft-interface
</code></p>

<p>Some models of Juniper SRX have a craft interface. This command will show you the LED status of the front panel.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Juniper Netscreen troubleshooting NSRP and HA]]></title>
    <link href="https://www.tunnelsup.com/juniper-netscreen-troubleshooting-nsrp-and-ha/"/>
    <updated>2014-08-26T15:47:00-07:00</updated>
    <id>https://www.tunnelsup.com/juniper-netscreen-troubleshooting-nsrp-and-ha</id>
    <content type="html"><![CDATA[<p>Some basic commands to help troubleshoot NSRP (failover/high availability) with Juniper Netscreen SSG devices.</p>

<h3>Review the NSRP configuration</h3>

<p>Here is a config pull from a working HA firewall config.</p>

<p><code>
netscreen:netscreen-cluster-pri(M)-&gt; get config | i nsrp
set nsrp cluster id 1
set nsrp cluster name netscreen-cluster
set nsrp rto-mirror sync
set nsrp rto-mirror route
set nsrp vsd-group id 0 priority 1
set nsrp vsd-group id 0 preempt
set nsrp vsd-group id 0 preempt hold-down 20
set nsrp secondary-path ethernet0/1
set nsrp monitor interface ethernet0/0
set nsrp monitor interface ethernet0/1
set nsrp monitor interface ethernet2/6
set nsrp monitor interface ethernet2/5
set nsrp monitor interface ethernet2/4
set nsrp monitor interface ethernet2/0
set nsrp monitor interface ethernet2/1
</code></p>

<h3>Examine the current NSRP state</h3>

<p>Some commands to examine the state of the situation</p>

<p>```
netscreen:netscreen-pri(M)&ndash;> get nsrp vsd-group all</p>

<p>VSD group info:
init hold time: 8
heartbeat lost threshold: 3
heartbeat interval: 1000(ms)
master always exist: disabled
group priority preempt holddown inelig   master       PB other members</p>

<pre><code>0        1 yes           20 no       myself 13691648
</code></pre>

<p>total number of vsd groups: 1
Total iteration=16523170,time=603985353,max=119017,min=2779,average=36</p>

<p>vsd group id: 0, member count: 2, master: 13690368</p>

<h2>member information:</h2>

<h2>group  unit_id  state          prio flag rto_peer   hb miss holddown</h2>

<pre><code>0 13691648  primary backup  100    0        0    1    0        3
0 13690368  master            1    2        0    0    0       20
</code></pre>

<p>```</p>

<p>Some interesting things to get out of this command:</p>

<p><code>master = myself</code> This is good to know who the current active or master firewall is.</p>

<p><code>member count = 2</code> If this is 2 it means there is another firewall joined to this VSD group.</p>

<p>Another command is simply <code>get nsrp</code>. This will show the <em>which is the HA interface</em>, as well as other information.</p>

<h3>Determine the last time a failover occurred</h3>

<p>The only way to do this is to check the logs.</p>

<p><code>
netscreen:netscreen-pri(M)-&gt; get event | incl nsrp
2014-08-25 14:03:39 system crit  00015 NSRP: HA control channel change to
2014-08-25 14:03:27 system crit  00015 NSRP: HA control channel change to
2014-08-25 14:01:44 system crit  00015 NSRP: HA control channel change to
2014-08-25 14:00:53 system crit  00015 NSRP: HA control channel change to
</code></p>

<p>This only tells half the story. From here we can see that the syslog type is 00015. Let&rsquo;s take a look at the logs filtering on that log type only:</p>

<p>```
netscreen:netscreen-pri(M)&ndash;> get event type 00015
get event type 00015
Date       Time     Module Level  Type Description
2014-08-25 14:03:39 system crit  00015 NSRP: HA control channel change to</p>

<pre><code>                                   ethernet2.
</code></pre>

<p>2014-08-25 14:03:27 system crit  00015 NSRP: HA control channel change to</p>

<pre><code>                                   NULL.(disconnected).
</code></pre>

<p>2014-08-25 14:01:44 system crit  00015 NSRP: HA control channel change to</p>

<pre><code>                                   ethernet2.
</code></pre>

<p>2014-08-25 14:00:53 system crit  00015 NSRP: HA control channel change to</p>

<pre><code>                                   NULL.(disconnected).
</code></pre>

<p>2014-08-25 14:00:49 system crit  00015 NSRP: HA control channel change to</p>

<pre><code>                                   ethernet2.
</code></pre>

<p>2014-08-25 14:00:41 system crit  00015 NSRP: HA control channel change to</p>

<pre><code>                                   NULL.(disconnected).
</code></pre>

<p>```</p>

<h3>Initiate a manual failover</h3>

<p>Here is the command to conduct a failover. Execute this from the primary firewall:</p>

<p><code>exec nsrp vsd-group 0 mode backup</code></p>

<h3>Additional problems</h3>

<p>From the primary firewall there is not a way to see what the IP is of the backup firewall. The primary firewall will utilize the IP addresses in the config. The one exception to this is the management IP. This is configured seperately on each firewall in the cluster.</p>

<p>There is not a way to view the logs in the backup device from the primary.</p>
]]></content>
  </entry>
  
  <entry>
    <title type="html"><![CDATA[Juniper SRX troubleshooting SNMP polling]]></title>
    <link href="https://www.tunnelsup.com/juniper-srx-troubleshooting-snmp-polling/"/>
    <updated>2014-08-26T15:46:00-07:00</updated>
    <id>https://www.tunnelsup.com/juniper-srx-troubleshooting-snmp-polling</id>
    <content type="html"><![CDATA[<p>Having trouble doing an SNMP walk on a Juniper SRX? Here are some troubleshooting tips to help solve the problem.</p>

<h2>Configure the SRX for SNMP</h2>

<p>First things first, make sure the config is set up right on the SRX so it&rsquo;s accepting SNMP polling.</p>

<p><code>
set snmp name SRX-HOSTNAME
set snmp community myCommunityString authorization read-write
set snmp community myCommunityString clients 10.1.60.0/24
set security zones security-zone TRUST interfaces ge-0/0/0.0 host-inbound-traffic system-services snmp
</code></p>

<p>In these commands we set an SNMP name, then give permission for the 10.1.60.0/24 network to do SNMP polling. We are also setting the community string to &lsquo;myCommunityString.&rsquo;</p>

<p>After this is configured we should be able to get on a linux device in the 10.1.60.0/24 network and issue the following command:</p>

<p><code>snmpwalk -c myCommunityString -v 2c 192.168.55.55</code></p>

<p>A large amount of data should come back listing all of the SNMP data. If that didn&rsquo;t work try some of the troubleshooting tips below.</p>

<h2>SNMP walk yourself</h2>

<p>The SRX has the ability to do an SNMP poll on itself with the following command</p>

<p><code>
show snmp mib walk jnxMibs
</code></p>

<p>This command should spit out a lot of data showing all of the jnxMibs in the database. <a href="http://www.juniper.net/techpubs/en_US/junos12.3/topics/reference/general/snmp-junos-faq.html">Juniper has documentation if this doesn&rsquo;t poll</a>:</p>

<p>What can I do if the MIB OID query is not responding?</p>

<p>There can be various reasons why the MIB OID query stops responding. One reason could be that the MIB itself is unresponsive. To verify that the MIB responds, use the show snmp mib walk | get MIB name | MIB OID command:</p>

<blockquote><p>If the MIB responds, the communication issue exists between the SNMP master and SNMP agent. Possible reasons for this issue include network issues, an incorrect community configuration, an incorrect SNMP configuration, and so on.
If the MIB does not respond, enable SNMP traceoptions to log PDUs and errors. All incoming and outgoing SNMP PDUs are logged. Check the traceoptions output to see if there are any errors.</p>

<p>If you continue to have problems with the MIB OID query, technical product support is available through the Juniper Networks Technical Assistance Center (JTAC).</p></blockquote>

<h2>Turn on Traceoptions</h2>

<p>Turning on traceoptions for SNMP will help see what the SRX is doing when it gets the SNMP poll request. Turn on traceoptions with the following edit commands:</p>

<p><code>
edit snmp traceoptions
set file trace_snmp
set flag all
</code></p>

<p>Try your SNMP walk again from a linux machine and then take a look at the log with <code>show log trace_snmp</code>.</p>

<p><strong>If</strong> you don&rsquo;t see anything showing up in the trace options there&rsquo;s one of two things wrong.</p>

<ul>
<li>Security settings are restricting SNMP polls from coming into the interface you&rsquo;re coming in on. Verify which interface you&rsquo;re polling and check that host-inbound-traffic is permitted. See the Configure SNMP section at the top of this blog post to understand that command.</li>
<li>The SNMP poll may not even be arriving at the SRX. It&rsquo;s possible the SNMP poll is being blocked somewhere or doesn&rsquo;t know how to make it to the SRX. Verify routing is working correctly and that port 161 isn&rsquo;t blocked.</li>
</ul>


<p><strong>If</strong> you are seeing some stuff happening in the logs when trying the SNMP walk command take a look at the following to understand the output.</p>

<h3>Understanding the snmp traceoptions results</h3>

<p>Let&rsquo;s look at a successfull SNMP poll that shows up in the traceoptions log.</p>

<p><code>
Aug 25 20:49:29 snmpd[5f07] &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
Aug 25 20:49:29 snmpd[5f07] &gt;&gt;&gt; Get-Request
Aug 25 20:49:29 snmpd[5f07] &gt;&gt;&gt;  Source:      10.1.60.200
Aug 25 20:49:29 snmpd[5f07] &gt;&gt;&gt;  Destination: 192.168.55.55
Aug 25 20:49:29 snmpd[5f07] &gt;&gt;&gt;  Version:     SNMPv2
Aug 25 20:49:29 snmpd[5f07] &gt;&gt;&gt;  Request_id:  0x5f07
Aug 25 20:49:29 snmpd[5f07] &gt;&gt;&gt;  Community:   myCommunityString
Aug 25 20:49:29 snmpd[5f07] &gt;&gt;&gt;  Error:       status=0 / vb_index=0
Aug 25 20:49:29 snmpd[5f07] &gt;&gt;&gt;   OID  : ifOperStatus.578
Aug 25 20:49:29 snmpd[5f07] &gt;&gt;&gt;   OID  : ifName.578
Aug 25 20:49:29 snmpd[5f07] &gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;&gt;
Aug 25 20:49:29 jnx_ifEntry_stat_actual_lookup: sync request for ae0.50
Aug 25 20:49:29 jnx_ifEntry_stat_actual_lookup: sync request for ae0.50
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt; Get-Response
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;  Source:      10.1.60.200
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;  Destination: 192.168.55.55
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;  Version:     SNMPv2
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;  Request_id:  0x5f07
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;  Community:   myCommunityString
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;  Error:       status=0 / vb_index=0
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;   OID  : ifOperStatus.578
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;   type : Number
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;   value: 1
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;   OID  : ifName.578
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;   type : OctetString
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;   value: "ae0.50"
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;   HEX  : 61 65 30 2e  35 30
Aug 25 20:49:29 snmpd[5f07]  &lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;
</code></p>

<p>When there are <code>&gt;&gt;&gt;</code> symbols it means that was an incoming SNMP request. When there are <code>&lt;&lt;&lt;</code> it means that&rsquo;s a SNMP response. In the case above we see the SNMP request come in from 10.1.60.200 going to the SRX at 192.168.55.55 using SNMP string myCommunityString. Within the same second we see the SRX responding with the information requested in the SNMP poll.</p>

<p>If the logs are showing the request but no response it may mean that the SNMP configuration doesn&rsquo;t have this source IP listed in the client. See the section on configuring SNMP at the top of this post to verify the network is present.</p>
]]></content>
  </entry>
  
</feed>
